  [1m[35m (0.2ms)[0m  [1m[35mCREATE DATABASE "xpark_backend_development" ENCODING = 'unicode'[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE DATABASE "xpark_backend_test" ENCODING = 'unicode'[0m
  [1m[35m (0.4ms)[0m  [1m[35mCREATE DATABASE "xpark_backend_development" ENCODING = 'unicode'[0m
  [1m[35m (0.2ms)[0m  [1m[35mCREATE DATABASE "xpark_backend_test" ENCODING = 'unicode'[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6259495107986884680)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to DeviseTokenAuthCreateUsers (20220128154721)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.8ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "provider" character varying DEFAULT 'email' NOT NULL, "uid" character varying DEFAULT '' NOT NULL, "encrypted_password" character varying DEFAULT '' NOT NULL, "reset_password_token" character varying, "reset_password_sent_at" timestamp, "allow_password_change" boolean DEFAULT FALSE, "remember_created_at" timestamp, "confirmation_token" character varying, "confirmed_at" timestamp, "confirmation_sent_at" timestamp, "unconfirmed_email" character varying, "name" character varying, "nickname" character varying, "image" character varying, "email" character varying, "tokens" json, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_email" ON "users"  ("email")[0m
  [1m[35m (2.6ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_uid_and_provider" ON "users"  ("uid", "provider")[0m
  [1m[35m (2.6ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_reset_password_token" ON "users"  ("reset_password_token")[0m
  [1m[35m (2.5ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_confirmation_token" ON "users"  ("confirmation_token")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128154721"]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2022-01-28 15:47:56.666897"], ["updated_at", "2022-01-28 15:47:56.666897"]]
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(6259495107986884680)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/api/v1/auth" for ::1 at 2022-01-28 17:00:54 +0100
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (No route matches [GET] "/api/v1/auth"):
  
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:36:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started POST "/api/v1/auth" for ::1 at 2022-01-28 17:01:00 +0100
Processing by DeviseTokenAuth::RegistrationsController#create as JSON
  Parameters: {"name"=>"jeff Bezos", "nickname"=>"amazon", "registration"=>{"name"=>"jeff Bezos", "nickname"=>"amazon"}}
[31mUnpermitted parameters: :name, :nickname, :registration[0m
Filter chain halted as :validate_sign_up_params rendered or redirected
Completed 422 Unprocessable Entity in 20ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 14677)


Started POST "/api/v1/auth" for ::1 at 2022-01-28 17:01:23 +0100
Processing by DeviseTokenAuth::RegistrationsController#create as JSON
  Parameters: {"name"=>"jeff Bezos", "nickname"=>"amazon", "email"=>"jeff@email.com", "registration"=>{"name"=>"jeff Bezos", "nickname"=>"amazon", "email"=>"jeff@email.com"}}
[31mUnpermitted parameters: :name, :nickname, :registration[0m
[31mUnpermitted parameters: :name, :nickname, :registration[0m
[31mUnpermitted parameters: :name, :nickname, :registration[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.1ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "jeff@email.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
Completed 422 Unprocessable Entity in 36ms (Views: 0.3ms | ActiveRecord: 7.9ms | Allocations: 16795)


Started POST "/api/v1/auth" for ::1 at 2022-01-28 17:01:50 +0100
Processing by DeviseTokenAuth::RegistrationsController#create as JSON
  Parameters: {"name"=>"jeff Bezos", "nickname"=>"amazon", "email"=>"jeff@email.com", "password"=>"[FILTERED]", "registration"=>{"name"=>"jeff Bezos", "nickname"=>"amazon", "email"=>"jeff@email.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameters: :name, :nickname, :registration[0m
[31mUnpermitted parameters: :name, :nickname, :registration[0m
[31mUnpermitted parameters: :name, :nickname, :registration[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "jeff@email.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["uid", "jeff@email.com"], ["encrypted_password", "$2a$12$s9ZljxBxPLU6ePQiWLzN8.VuckzwcyrXDqbvW7F5E3MvlIBvdaAGS"], ["email", "jeff@email.com"], ["created_at", "2022-01-28 16:01:50.616338"], ["updated_at", "2022-01-28 16:01:50.616338"]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"MGOU2VBY-wmrsXEcE8933A\\\":{\\\"token\\\":\\\"$2a$10$i3k2djvFdKUsnDYgAz2jLOhdBywBVpOjhS.UzClkWGUYWXgc6VC2C\\\",\\\"expiry\\\":1644595310}}\""], ["updated_at", "2022-01-28 16:01:50.684089"], ["id", 1]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"MGOU2VBY-wmrsXEcE8933A\\\":{\\\"token\\\":\\\"$2a$10$hNmZEYl.n3fyP5s7s6mPmOgBwEMRgY7GrPDoa/kj.pZFLheBnbcry\\\",\\\"expiry\\\":1644595310,\\\"last_token\\\":\\\"$2a$10$i3k2djvFdKUsnDYgAz2jLOhdBywBVpOjhS.UzClkWGUYWXgc6VC2C\\\",\\\"updated_at\\\":\\\"2022-01-28T16:01:50Z\\\"}}\""], ["updated_at", "2022-01-28 16:01:50.756450"], ["id", 1]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 402ms (Views: 0.2ms | ActiveRecord: 7.4ms | Allocations: 19002)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-28 17:03:29 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"jeff@email.com", "password"=>"[FILTERED]", "session"=>{"email"=>"jeff@email.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "jeff@email.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"MGOU2VBY-wmrsXEcE8933A\\\":{\\\"token\\\":\\\"$2a$10$hNmZEYl.n3fyP5s7s6mPmOgBwEMRgY7GrPDoa/kj.pZFLheBnbcry\\\",\\\"expiry\\\":1644595310,\\\"last_token\\\":\\\"$2a$10$i3k2djvFdKUsnDYgAz2jLOhdBywBVpOjhS.UzClkWGUYWXgc6VC2C\\\",\\\"updated_at\\\":\\\"2022-01-28T16:01:50Z\\\"},\\\"HAGchT-bsfIP6NEbroJGdQ\\\":{\\\"token\\\":\\\"$2a$10$mVYp4B6hO6BRWN1YsxKNHefrRc4wE5aNWtxqKOIVEUThf0oT2PTtu\\\",\\\"expiry\\\":1644595409}}\""], ["updated_at", "2022-01-28 16:03:29.578000"], ["id", 1]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"MGOU2VBY-wmrsXEcE8933A\\\":{\\\"token\\\":\\\"$2a$10$hNmZEYl.n3fyP5s7s6mPmOgBwEMRgY7GrPDoa/kj.pZFLheBnbcry\\\",\\\"expiry\\\":1644595310,\\\"last_token\\\":\\\"$2a$10$i3k2djvFdKUsnDYgAz2jLOhdBywBVpOjhS.UzClkWGUYWXgc6VC2C\\\",\\\"updated_at\\\":\\\"2022-01-28T16:01:50Z\\\"},\\\"HAGchT-bsfIP6NEbroJGdQ\\\":{\\\"token\\\":\\\"$2a$10$cduvQU4.isEpjwE5nk55l.QfHnjqG/uDxUo/KRH/u4ACfqGlU9Y4a\\\",\\\"expiry\\\":1644595409,\\\"last_token\\\":\\\"$2a$10$mVYp4B6hO6BRWN1YsxKNHefrRc4wE5aNWtxqKOIVEUThf0oT2PTtu\\\",\\\"updated_at\\\":\\\"2022-01-28T16:03:29Z\\\"}}\""], ["updated_at", "2022-01-28 16:03:29.650976"], ["id", 1]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 404ms (Views: 0.3ms | ActiveRecord: 5.3ms | Allocations: 13193)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-28 17:06:03 +0100
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"jeff@email.com", "password"=>"[FILTERED]", "session"=>{"email"=>"jeff@email.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "jeff@email.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"MGOU2VBY-wmrsXEcE8933A\\\":{\\\"token\\\":\\\"$2a$10$hNmZEYl.n3fyP5s7s6mPmOgBwEMRgY7GrPDoa/kj.pZFLheBnbcry\\\",\\\"expiry\\\":1644595310,\\\"last_token\\\":\\\"$2a$10$i3k2djvFdKUsnDYgAz2jLOhdBywBVpOjhS.UzClkWGUYWXgc6VC2C\\\",\\\"updated_at\\\":\\\"2022-01-28T16:01:50Z\\\"},\\\"HAGchT-bsfIP6NEbroJGdQ\\\":{\\\"token\\\":\\\"$2a$10$cduvQU4.isEpjwE5nk55l.QfHnjqG/uDxUo/KRH/u4ACfqGlU9Y4a\\\",\\\"expiry\\\":1644595409,\\\"last_token\\\":\\\"$2a$10$mVYp4B6hO6BRWN1YsxKNHefrRc4wE5aNWtxqKOIVEUThf0oT2PTtu\\\",\\\"updated_at\\\":\\\"2022-01-28T16:03:29Z\\\"},\\\"xaTiYDdUFgwGLDJP83lbPw\\\":{\\\"token\\\":\\\"$2a$10$52jIdTV4wraDpBCgyqN3fevFv7o7253Z7t.dUhOPTuQ4/Jsy9Gmue\\\",\\\"expiry\\\":1644595563}}\""], ["updated_at", "2022-01-28 16:06:03.557644"], ["id", 1]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"MGOU2VBY-wmrsXEcE8933A\\\":{\\\"token\\\":\\\"$2a$10$hNmZEYl.n3fyP5s7s6mPmOgBwEMRgY7GrPDoa/kj.pZFLheBnbcry\\\",\\\"expiry\\\":1644595310,\\\"last_token\\\":\\\"$2a$10$i3k2djvFdKUsnDYgAz2jLOhdBywBVpOjhS.UzClkWGUYWXgc6VC2C\\\",\\\"updated_at\\\":\\\"2022-01-28T16:01:50Z\\\"},\\\"HAGchT-bsfIP6NEbroJGdQ\\\":{\\\"token\\\":\\\"$2a$10$cduvQU4.isEpjwE5nk55l.QfHnjqG/uDxUo/KRH/u4ACfqGlU9Y4a\\\",\\\"expiry\\\":1644595409,\\\"last_token\\\":\\\"$2a$10$mVYp4B6hO6BRWN1YsxKNHefrRc4wE5aNWtxqKOIVEUThf0oT2PTtu\\\",\\\"updated_at\\\":\\\"2022-01-28T16:03:29Z\\\"},\\\"xaTiYDdUFgwGLDJP83lbPw\\\":{\\\"token\\\":\\\"$2a$10$YeG8J3Y8xaCuviwpb0avt.P13dudX3iSF9DnVTMWRoR4dqALUQqga\\\",\\\"expiry\\\":1644595563,\\\"last_token\\\":\\\"$2a$10$52jIdTV4wraDpBCgyqN3fevFv7o7253Z7t.dUhOPTuQ4/Jsy9Gmue\\\",\\\"updated_at\\\":\\\"2022-01-28T16:06:03Z\\\"}}\""], ["updated_at", "2022-01-28 16:06:03.631648"], ["id", 1]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 409ms (Views: 0.2ms | ActiveRecord: 9.4ms | Allocations: 25145)


Started POST "/api/v1/auth" for ::1 at 2022-01-28 17:06:57 +0100
Processing by DeviseTokenAuth::RegistrationsController#create as JSON
  Parameters: {"name"=>"jeff Bezos", "nickname"=>"amazon", "email"=>"jeff@email.com", "password"=>"[FILTERED]", "registration"=>{"name"=>"jeff Bezos", "nickname"=>"amazon", "email"=>"jeff@email.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameters: :name, :nickname, :registration[0m
[31mUnpermitted parameters: :name, :nickname, :registration[0m
[31mUnpermitted parameters: :name, :nickname, :registration[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "jeff@email.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
Completed 422 Unprocessable Entity in 258ms (Views: 0.2ms | ActiveRecord: 1.5ms | Allocations: 11665)


Started POST "/api/v1/auth" for ::1 at 2022-01-28 17:08:07 +0100
Processing by DeviseTokenAuth::RegistrationsController#create as JSON
  Parameters: {"name"=>"jeff Bezos", "nickname"=>"amazon", "email"=>"jeff@email.com", "password"=>"[FILTERED]", "registration"=>{"name"=>"jeff Bezos", "nickname"=>"amazon", "email"=>"jeff@email.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
[31mUnpermitted parameter: :registration[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "jeff@email.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
Completed 422 Unprocessable Entity in 269ms (Views: 0.2ms | ActiveRecord: 2.8ms | Allocations: 15899)


  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6259495107986884680)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to AddRoleToUsers (20220128161614)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.5ms)[0m  [1m[35mALTER TABLE "users" ADD "role" integer[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128161614"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(6259495107986884680)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$0S5WRNdIWB44F4J9dDs0Tuh2f7bv7fLCinWWZSsxCozmIJf7DBY0i"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 16:19:33.935725"], ["updated_at", "2022-01-28 16:19:33.935725"], ["role", 1]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$kZ19BCn9KxX4fOs1gAbHF.af1z5M4YjlDJO65LBlo3GL0EO8bo8Nq"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 16:19:34.181050"], ["updated_at", "2022-01-28 16:19:34.181050"], ["role", 1]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-28 17:20:03 +0100
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"regular_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"regular_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"TI6UhsL9q3lxgG9kHHqhbA\\\":{\\\"token\\\":\\\"$2a$10$ItgYiNqLUzvrFNQrCVYjbuWexX1tXR38/ZFRcDmdrabVho/abcHTC\\\",\\\"expiry\\\":1644596404}}\""], ["updated_at", "2022-01-28 16:20:04.251114"], ["id", 2]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 2], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 2], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"TI6UhsL9q3lxgG9kHHqhbA\\\":{\\\"token\\\":\\\"$2a$10$iFqtgotqP49WncogE7wMlOY2QddSqQOnDFiadeeA2TYLFFzkxVp3q\\\",\\\"expiry\\\":1644596404,\\\"last_token\\\":\\\"$2a$10$ItgYiNqLUzvrFNQrCVYjbuWexX1tXR38/ZFRcDmdrabVho/abcHTC\\\",\\\"updated_at\\\":\\\"2022-01-28T16:20:04Z\\\"}}\""], ["updated_at", "2022-01-28 16:20:04.324811"], ["id", 2]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 407ms (Views: 0.2ms | ActiveRecord: 5.9ms | Allocations: 22930)


  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$eE3t7dSHPeTnWKGcT06ckuhRpo.izpp0vRthEMvRroZBIJ7gPFoOC"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 16:23:39.545121"], ["updated_at", "2022-01-28 16:23:39.545121"], ["role", 1]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$/3TVsMlhK5AlH6P5R5R2Iuqvmgr91P2ilRlLU9U.BF8BFBFc.zwTK"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 16:23:39.794482"], ["updated_at", "2022-01-28 16:23:39.794482"], ["role", 1]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$wOPQFRYYK9bfi2FExeKPqO.lG0Hb3c4V29dVY0sj2fbwOUV7ATDPS"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 16:23:40.045184"], ["updated_at", "2022-01-28 16:23:40.045184"], ["role", 0]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$JadLz6s6gJ4G4ihGvJIlguaIWHJLS9mlwgotlhlhcK4QFajzdlWcy"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 16:23:40.295216"], ["updated_at", "2022-01-28 16:23:40.295216"], ["role", 0]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-28 17:23:54 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"KpsNvFQQU_pTyfHd32_XMA\\\":{\\\"token\\\":\\\"$2a$10$S9.WmkK7I7HvMj.KxDgaQevFni5AjmvD/WvPlwXYguNx2OpEJ5zNW\\\",\\\"expiry\\\":1644596634}}\""], ["updated_at", "2022-01-28 16:23:54.477229"], ["id", 6]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 6], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 6], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"KpsNvFQQU_pTyfHd32_XMA\\\":{\\\"token\\\":\\\"$2a$10$P7hyutH750VvyV7BwmnXZeBinQPBL2HVor1lCe62JvfXwEZBsDrUm\\\",\\\"expiry\\\":1644596634,\\\"last_token\\\":\\\"$2a$10$S9.WmkK7I7HvMj.KxDgaQevFni5AjmvD/WvPlwXYguNx2OpEJ5zNW\\\",\\\"updated_at\\\":\\\"2022-01-28T16:23:54Z\\\"}}\""], ["updated_at", "2022-01-28 16:23:54.549959"], ["id", 6]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 396ms (Views: 0.2ms | ActiveRecord: 5.3ms | Allocations: 12880)


  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6259495107986884680)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to CreateStates (20220128204110)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying, "order" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128204110"]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateVehicles (20220128204223)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (6.1ms)[0m  [1m[35mCREATE TABLE "vehicles" ("id" bigserial primary key, "description" character varying, "user_id" bigint, "current_state_id" bigint, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.5ms)[0m  [1m[35mCREATE  INDEX  "index_vehicles_on_user_id" ON "vehicles"  ("user_id")[0m
  [1m[35m (2.6ms)[0m  [1m[35mCREATE  INDEX  "index_vehicles_on_current_state_id" ON "vehicles"  ("current_state_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128204223"]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(6259495107986884680)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$LP/sN8v8XH/FeJo3w5AjTeHxmnjoB61mNAh2pJeE1UJ1l3WHKes8K"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 21:04:19.878609"], ["updated_at", "2022-01-28 21:04:19.878609"], ["role", 1]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$wHxxvn1wxBD15jTLm5V9YeqJjWyGT9ftVkW0Bef2CG1jxfOlhAYnS"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 21:04:20.116137"], ["updated_at", "2022-01-28 21:04:20.116137"], ["role", 1]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$j8XBGHU9LOdB/aoF9TwYe.bSs64wBNcAjIRcBMcK8pT.tT6vROLL6"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 21:04:20.362731"], ["updated_at", "2022-01-28 21:04:20.362731"], ["role", 0]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$qfkYl4ja22nRIGTPGInnRe.TiH9aob8aJeho.ktvcJJaJiGFNhflC"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 21:04:20.607126"], ["updated_at", "2022-01-28 21:04:20.607126"], ["role", 0]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$RELF4C61.96qDtxxZRieNu7QJe45obGcSp9IouF8RYFv2Jp0z03oe"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 21:06:14.872984"], ["updated_at", "2022-01-28 21:06:14.872984"], ["role", 0]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$63f94KkN12TnWgzdGeDqHuzCZXa/BlxNuWpCxZxpsvFe1fA4bAfXK"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 21:06:15.111985"], ["updated_at", "2022-01-28 21:06:15.111985"], ["role", 0]]
  [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$N/HWyB4l9lojQISTzWh96ugvwjlOUUkZDKoZ7.WgzDJILkiamLZay"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 21:06:15.349859"], ["updated_at", "2022-01-28 21:06:15.349859"], ["role", 1]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.2ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$mPaOsqNrnGfWS4OBe/wxDuhgjx14x6J8nm/Z6EOYqj3CuXrK4Wy.."], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 21:06:15.589873"], ["updated_at", "2022-01-28 21:06:15.589873"], ["role", 1]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$8qL/eotKd2NfHDWfB6x3yObV5aLZKVFzjJvmbq9QWvJlYEN./PkD."], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 21:06:51.179226"], ["updated_at", "2022-01-28 21:06:51.179226"]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$9sDO6n62pi10hawOBnTieOXwpnvgCYiUXt6rXMZZTtZvGUR4Ls.uq"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 21:06:51.417570"], ["updated_at", "2022-01-28 21:06:51.417570"]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$PQ5CYSgiH734NTZu04tO6eHOBQLbwN7ckhGwBT0PcnKzBCkSwE1bO"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 21:06:51.654887"], ["updated_at", "2022-01-28 21:06:51.654887"], ["role", 1]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.2ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$hPEpmpQpKLB1Z/zFLIh8Qe7pMfySbsuqiB6glZPEcT.U1Q2d9lUyC"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 21:06:51.892468"], ["updated_at", "2022-01-28 21:06:51.892468"], ["role", 1]]
  [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$k.GvZK7Hy/Pzp2GdK7klOOPEeUVqo7Hq1t52p5wp3MboglZ6aiVzq"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 21:08:27.510311"], ["updated_at", "2022-01-28 21:08:27.510311"]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$8WJqcycoPihar5JDXsWZRO0D2rwzzPJf70FPBFBkOm9mgN3mkZr.6"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 21:08:27.750769"], ["updated_at", "2022-01-28 21:08:27.750769"]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$o.fySwE5EgZ/MdNBOwROVeODxAboq4gOU6Olc0Wg8K26do7.zIItS"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 21:08:27.989156"], ["updated_at", "2022-01-28 21:08:27.989156"], ["role", 0]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$qzrgXITQ8hBM1kgat69vdeQYEOnlJaWWZKGPeh7FU9z3JBR4ljiKS"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 21:08:28.228539"], ["updated_at", "2022-01-28 21:08:28.228539"], ["role", 0]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$qkV31esMA4tzbGbKCMjztOWIZOX04.6yX7psgG.Oolv.8/QekxVF2"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 21:09:10.847067"], ["updated_at", "2022-01-28 21:09:10.847067"]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$zS/Iq831.B2sgBjM2512.OJQfEwRPm8zGjhcXrnoRJVkM47PDM36m"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 21:09:11.086180"], ["updated_at", "2022-01-28 21:09:11.086180"]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$FINPVv3Wv1ruypWXwxOydeue5ml3dHAM/zMzEx5GtN1v6pOUKOuAa"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 21:09:11.321903"], ["updated_at", "2022-01-28 21:09:11.321903"], ["role", 1]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$tw4H0AK1pZYwRHjccKJhpushnArzM.mEetQpjkNaKlBzhT/D0N4ja"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 21:09:11.560201"], ["updated_at", "2022-01-28 21:09:11.560201"], ["role", 1]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$yEk4N3QYNtK7jCQmMnfNKuHMgn4h2DK2wnbhlrjOMwJUZPxwBwcN6"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 21:14:10.389081"], ["updated_at", "2022-01-28 21:14:10.389081"]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$Nzrav4zCI4HGVh.AmPTDjuUFfHF6agjJAFtpQtpM.28hkD7FRBpKO"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 21:14:10.634565"], ["updated_at", "2022-01-28 21:14:10.634565"]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$wPjGhmb81SwCQr3YrQ3Vwe4.fyyXgrHAbxVCJIodpMsbQ2jcCeOQW"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 21:14:10.891370"], ["updated_at", "2022-01-28 21:14:10.891370"], ["role", 0]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$OEkRAxE1A0ipoBBRtD7MxOjillqOzBiI0frvg3EYTZP.WFYtyaebu"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 21:14:11.140893"], ["updated_at", "2022-01-28 21:14:11.140893"], ["role", 0]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6259495107986884680)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to SetDefaultValue (20220128211623)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "users" ALTER COLUMN "role" SET DEFAULT 1[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.2ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128211623"]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(6259495107986884680)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$2xEJjLB811rbVw4q1mPo.OA4YhjxDFx.Q.4cuSCQzpVveb0KtbPOS"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 21:17:27.728540"], ["updated_at", "2022-01-28 21:17:27.728540"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$seidicdBks7DXIlQ8HDHQ.Xfb3J0FGoqjHxq.OqYHDxi6c9vE0QDu"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 21:17:27.969076"], ["updated_at", "2022-01-28 21:17:27.969076"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$7w3H6l.fnCDe44Dus6ENruoIyXbZMu9199Y0S7Z4Mt2/jiMF2IY.e"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 21:17:28.206661"], ["updated_at", "2022-01-28 21:17:28.206661"], ["role", 0]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$HibfXYcyUgn8zly.qpVp4Oh3Efebt4BJprh9ZobsBWufBP/c840K."], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 21:17:28.453445"], ["updated_at", "2022-01-28 21:17:28.453445"], ["role", 0]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (26.9ms)[0m  [1m[35mDROP DATABASE IF EXISTS "xpark_backend_development"[0m
  [1m[35m (25.0ms)[0m  [1m[35mDROP DATABASE IF EXISTS "xpark_backend_test"[0m
  [1m[35m (56.6ms)[0m  [1m[35mCREATE DATABASE "xpark_backend_development" ENCODING = 'unicode'[0m
  [1m[35m (50.7ms)[0m  [1m[35mCREATE DATABASE "xpark_backend_test" ENCODING = 'unicode'[0m
  [1m[35m (7.5ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (6.4ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6259495107986884680)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to DeviseTokenAuthCreateUsers (20220128154721)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (6.1ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "provider" character varying DEFAULT 'email' NOT NULL, "uid" character varying DEFAULT '' NOT NULL, "encrypted_password" character varying DEFAULT '' NOT NULL, "reset_password_token" character varying, "reset_password_sent_at" timestamp, "allow_password_change" boolean DEFAULT FALSE, "remember_created_at" timestamp, "confirmation_token" character varying, "confirmed_at" timestamp, "confirmation_sent_at" timestamp, "unconfirmed_email" character varying, "name" character varying, "nickname" character varying, "image" character varying, "email" character varying, "tokens" json, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.7ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_email" ON "users"  ("email")[0m
  [1m[35m (2.6ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_uid_and_provider" ON "users"  ("uid", "provider")[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_reset_password_token" ON "users"  ("reset_password_token")[0m
  [1m[35m (2.0ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_confirmation_token" ON "users"  ("confirmation_token")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128154721"]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddRoleToUsers (20220128161614)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.6ms)[0m  [1m[35mALTER TABLE "users" ADD "role" integer[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.5ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128161614"]]
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateStates (20220128204110)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (5.2ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying, "order" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128204110"]]
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateVehicles (20220128204223)
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (5.0ms)[0m  [1m[35mCREATE TABLE "vehicles" ("id" bigserial primary key, "name" character varying, "user_id" bigint, "current_state_id" bigint, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE  INDEX  "index_vehicles_on_user_id" ON "vehicles"  ("user_id")[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE  INDEX  "index_vehicles_on_current_state_id" ON "vehicles"  ("current_state_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128204223"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Migrating to SetDefaultValue (20220128211623)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.3ms)[0m  [1m[35mALTER TABLE "users" ALTER COLUMN "role" SET DEFAULT 1[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128211623"]]
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.3ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.3ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2022-01-28 21:54:06.642845"], ["updated_at", "2022-01-28 21:54:06.642845"]]
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_advisory_unlock(6259495107986884680)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$pu/Ra0RoSgbw84RYnG2L/e27sCHe9ztDgHLnR61WzHm.RDvGb48lu"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 21:54:16.116980"], ["updated_at", "2022-01-28 21:54:16.116980"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$/yAKoJ5.AWQ8uMYOqcpj7eDuaRb9H5MVIjrjKbBVOpl7wzWijgdte"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 21:54:16.359073"], ["updated_at", "2022-01-28 21:54:16.359073"]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$ZqD2lXIu3QAqjEpL.Q1/vug8UCKvK8qhUw6muXyZeZBgDoiwiM0qK"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 21:54:16.603350"], ["updated_at", "2022-01-28 21:54:16.603350"], ["role", 0]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$R.pwpS7BFTF3fWBQ.MFQauKIgP0lKpZiE/LKadiTEYg2zcNq6n4vm"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 21:54:16.844628"], ["updated_at", "2022-01-28 21:54:16.844628"], ["role", 0]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:46:36.254542', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Assembled"], ["order", 1], ["created_at", "2022-01-28 22:46:36.254157"], ["updated_at", "2022-01-28 22:46:36.254157"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:46:36.265811', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 2)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Painted"], ["order", 2], ["created_at", "2022-01-28 22:46:36.265625"], ["updated_at", "2022-01-28 22:46:36.265625"]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:46:36.276398', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Tested"], ["order", 3], ["created_at", "2022-01-28 22:46:36.276229"], ["updated_at", "2022-01-28 22:46:36.276229"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:46:36.285722', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 4)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Designed"], ["order", 4], ["created_at", "2022-01-28 22:46:36.285521"], ["updated_at", "2022-01-28 22:46:36.285521"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:47:21.575210', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Assembled"], ["order", 1], ["created_at", "2022-01-28 22:47:21.574864"], ["updated_at", "2022-01-28 22:47:21.574864"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:47:21.586926', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 2)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Painted"], ["order", 2], ["created_at", "2022-01-28 22:47:21.586740"], ["updated_at", "2022-01-28 22:47:21.586740"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:47:21.596390', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Tested"], ["order", 3], ["created_at", "2022-01-28 22:47:21.596243"], ["updated_at", "2022-01-28 22:47:21.596243"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 7], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:47:21.606644', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 4)[0m
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Designed"], ["order", 4], ["created_at", "2022-01-28 22:47:21.606476"], ["updated_at", "2022-01-28 22:47:21.606476"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 8], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:02.543574', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Assembled"], ["order", 1], ["created_at", "2022-01-28 22:48:02.543187"], ["updated_at", "2022-01-28 22:48:02.543187"]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:02.554668', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 2)[0m
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Painted"], ["order", 2], ["created_at", "2022-01-28 22:48:02.554494"], ["updated_at", "2022-01-28 22:48:02.554494"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:02.563146', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Tested"], ["order", 3], ["created_at", "2022-01-28 22:48:02.562990"], ["updated_at", "2022-01-28 22:48:02.562990"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:02.572390', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 4)[0m
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Designed"], ["order", 4], ["created_at", "2022-01-28 22:48:02.572226"], ["updated_at", "2022-01-28 22:48:02.572226"]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 12], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$DVvnSkKWPDeB/g2KXm2abO6Rtg.k36cCaEWh.QQ9ar39VBnsfEtXm"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 22:48:36.878110"], ["updated_at", "2022-01-28 22:48:36.878110"]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$Xh7s2Cx9rep1kyVg0w2y6u1sdW6EoaZFE0uIDyaMckiEcwa1Jrdre"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 22:48:37.146367"], ["updated_at", "2022-01-28 22:48:37.146367"]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$7aqXhu6n.5354tQeMQf8b.8VHV9l1Tx2wvRPScRXaGQrptAQrv9Ha"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 22:48:37.417674"], ["updated_at", "2022-01-28 22:48:37.417674"], ["role", 0]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$FppM.W/xiRCTwpLqgM/TreQPr6jEQ3wA4ss51CCDNeboAt3CEwjKm"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 22:48:37.675926"], ["updated_at", "2022-01-28 22:48:37.675926"], ["role", 0]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:37.690794', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Assembled"], ["order", 1], ["created_at", "2022-01-28 22:48:37.690460"], ["updated_at", "2022-01-28 22:48:37.690460"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:37.701560', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 2)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Painted"], ["order", 2], ["created_at", "2022-01-28 22:48:37.701379"], ["updated_at", "2022-01-28 22:48:37.701379"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 14], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:37.711177', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Tested"], ["order", 3], ["created_at", "2022-01-28 22:48:37.710920"], ["updated_at", "2022-01-28 22:48:37.710920"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:37.721595', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 4)[0m
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Designed"], ["order", 4], ["created_at", "2022-01-28 22:48:37.721435"], ["updated_at", "2022-01-28 22:48:37.721435"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.7ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.5ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:52.583983', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Assembled"], ["order", 1], ["created_at", "2022-01-28 22:48:52.583648"], ["updated_at", "2022-01-28 22:48:52.583648"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 17], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:52.594826', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 2)[0m
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Painted"], ["order", 2], ["created_at", "2022-01-28 22:48:52.594660"], ["updated_at", "2022-01-28 22:48:52.594660"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 18], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:52.603031', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Tested"], ["order", 3], ["created_at", "2022-01-28 22:48:52.602883"], ["updated_at", "2022-01-28 22:48:52.602883"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 19], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.5ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:48:52.612271', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 4)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Designed"], ["order", 4], ["created_at", "2022-01-28 22:48:52.612072"], ["updated_at", "2022-01-28 22:48:52.612072"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 20], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (1.0ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$x0c8aLpIqt7lc6Sr3SeOievNhl.MMXUmA4eUdI3hlFLM7iavekcrW"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 22:49:07.495242"], ["updated_at", "2022-01-28 22:49:07.495242"]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$zMUab4ARtW7vNNEPthRQrux2n.4aVhV0Sg7AOPU4SWKpedUtWQK0W"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 22:49:07.759778"], ["updated_at", "2022-01-28 22:49:07.759778"]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$toz8iYZP6Lqq1RYRQnal2..0DPN7hBNdiR30QvTAvY9iSzrtxryhu"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 22:49:08.037199"], ["updated_at", "2022-01-28 22:49:08.037199"], ["role", 0]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$J24htdHfkWApgpZ3LXLgxu6l79zsLtZzRMYmJxgRFdo3SmWc0e2t6"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 22:49:08.312070"], ["updated_at", "2022-01-28 22:49:08.312070"], ["role", 0]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.5ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:49:08.327322', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Assembled"], ["order", 1], ["created_at", "2022-01-28 22:49:08.326919"], ["updated_at", "2022-01-28 22:49:08.326919"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 21], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:49:08.336745', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 2)[0m
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Painted"], ["order", 2], ["created_at", "2022-01-28 22:49:08.336600"], ["updated_at", "2022-01-28 22:49:08.336600"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 22], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.6ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:49:08.345964', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Tested"], ["order", 3], ["created_at", "2022-01-28 22:49:08.345800"], ["updated_at", "2022-01-28 22:49:08.345800"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 23], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 22:49:08.355716', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 4)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Designed"], ["order", 4], ["created_at", "2022-01-28 22:49:08.355544"], ["updated_at", "2022-01-28 22:49:08.355544"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 24], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.9ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "BMW"], ["user_id", 9], ["created_at", "2022-01-28 22:49:08.373343"], ["updated_at", "2022-01-28 22:49:08.373343"]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.5ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Toyota"], ["user_id", 9], ["created_at", "2022-01-28 22:49:08.380901"], ["updated_at", "2022-01-28 22:49:08.380901"]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.3ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Mercedes"], ["user_id", 10], ["created_at", "2022-01-28 22:49:08.387571"], ["updated_at", "2022-01-28 22:49:08.387571"]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.3ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Seat"], ["user_id", 10], ["created_at", "2022-01-28 22:49:08.393522"], ["updated_at", "2022-01-28 22:49:08.393522"]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.5ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Clio"], ["user_id", 11], ["created_at", "2022-01-28 22:49:08.399892"], ["updated_at", "2022-01-28 22:49:08.399892"]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.4ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Renault"], ["user_id", 12], ["created_at", "2022-01-28 22:49:08.411349"], ["updated_at", "2022-01-28 22:49:08.411349"]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-28 23:55:28 +0100
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"dBRqDHIFM5WHfJa4F3ULuQ\\\":{\\\"token\\\":\\\"$2a$10$sugXEaXIP2k515jryxsDXu1h3gSmgvF/ZR/pqrAB45cd6o1G5/b9e\\\",\\\"expiry\\\":1644620129}}\""], ["updated_at", "2022-01-28 22:55:29.326807"], ["id", 11]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"dBRqDHIFM5WHfJa4F3ULuQ\\\":{\\\"token\\\":\\\"$2a$10$3kMs7EWZlwTlWCuXvqoJqOx/hII3nLMhF9HO3q8X3XAH/zf7isS4u\\\",\\\"expiry\\\":1644620129,\\\"last_token\\\":\\\"$2a$10$sugXEaXIP2k515jryxsDXu1h3gSmgvF/ZR/pqrAB45cd6o1G5/b9e\\\",\\\"updated_at\\\":\\\"2022-01-28T22:55:29Z\\\"}}\""], ["updated_at", "2022-01-28 22:55:29.399795"], ["id", 11]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 402ms (Views: 0.1ms | ActiveRecord: 8.1ms | Allocations: 25658)


Started GET "/api/v1/vehicles" for ::1 at 2022-01-28 23:58:10 +0100
  
ActionController::RoutingError (uninitialized constant Api):
  
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:92:in `rescue in controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:81:in `controller_class'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:44:in `controller'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:49:in `block in serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:834:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.0.4.4) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/api/v1/vehicles" for ::1 at 2022-01-28 23:58:15 +0100
  
ActionController::RoutingError (uninitialized constant Api):
  
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:92:in `rescue in controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:81:in `controller_class'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:44:in `controller'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:49:in `block in serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:834:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.0.4.4) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/api/v1/vehicles" for ::1 at 2022-01-28 23:58:28 +0100
  
ActionController::RoutingError (uninitialized constant Api):
  
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:92:in `rescue in controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:81:in `controller_class'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:44:in `controller'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:49:in `block in serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:834:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.0.4.4) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/vehicles" for ::1 at 2022-01-29 00:00:20 +0100
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.2ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 11]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 11], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"dBRqDHIFM5WHfJa4F3ULuQ\\\":{\\\"token\\\":\\\"$2a$10$icwOwHhVQ7XQcdZZnf7YWuAOTtYC5Ffb3qL1ytN1bY1V1hewyG9p2\\\",\\\"expiry\\\":1644620421,\\\"last_token\\\":\\\"$2a$10$3kMs7EWZlwTlWCuXvqoJqOx/hII3nLMhF9HO3q8X3XAH/zf7isS4u\\\",\\\"updated_at\\\":\\\"2022-01-28T23:00:21Z\\\"}}\""], ["updated_at", "2022-01-28 23:00:21.168885"], ["id", 11]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 169ms (Views: 0.1ms | ActiveRecord: 10.8ms | Allocations: 29308)


  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.6ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$TKgHpRwsUgBPSKyeaL.QS.k0JkmgRmXigjZuwDaKQ6UipULItgN.6"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-28 23:04:38.267806"], ["updated_at", "2022-01-28 23:04:38.267806"]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$cVJ6igPNpy7pmZuFYr24BOLp7qHb4pG3x/GTLM3eW0Hk6DJS1plVq"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-28 23:04:38.505086"], ["updated_at", "2022-01-28 23:04:38.505086"]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$yIyw.0OryygZpHvYlSDHg.gz3mIQ1ZpO/qbPXWoRwRbRTNFALt.VS"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-28 23:04:38.740800"], ["updated_at", "2022-01-28 23:04:38.740800"], ["role", 0]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.3ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.3ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$dJHBLZrtUtfchh3THJSy6.oyvNdYYHvHfEGE9wOJNYhbsi9CJF8am"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-28 23:04:38.980509"], ["updated_at", "2022-01-28 23:04:38.980509"], ["role", 0]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 23:04:38.992332', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Assembled"], ["order", 1], ["created_at", "2022-01-28 23:04:38.992064"], ["updated_at", "2022-01-28 23:04:38.992064"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 25], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 23:04:38.999961', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 2)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Painted"], ["order", 2], ["created_at", "2022-01-28 23:04:38.999787"], ["updated_at", "2022-01-28 23:04:38.999787"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 26], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 23:04:39.007161', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  [1m[36mState Create (0.1ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Tested"], ["order", 3], ["created_at", "2022-01-28 23:04:39.007048"], ["updated_at", "2022-01-28 23:04:39.007048"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 27], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-28 23:04:39.013926', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 4)[0m
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Designed"], ["order", 4], ["created_at", "2022-01-28 23:04:39.013810"], ["updated_at", "2022-01-28 23:04:39.013810"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 28], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.3ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "BMW"], ["user_id", 13], ["current_state_id", 25], ["created_at", "2022-01-28 23:04:39.028428"], ["updated_at", "2022-01-28 23:04:39.028428"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.2ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Toyota"], ["user_id", 13], ["current_state_id", 25], ["created_at", "2022-01-28 23:04:39.032811"], ["updated_at", "2022-01-28 23:04:39.032811"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.2ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Mercedes"], ["user_id", 14], ["current_state_id", 25], ["created_at", "2022-01-28 23:04:39.037028"], ["updated_at", "2022-01-28 23:04:39.037028"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.2ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Seat"], ["user_id", 14], ["current_state_id", 25], ["created_at", "2022-01-28 23:04:39.040986"], ["updated_at", "2022-01-28 23:04:39.040986"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.3ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Clio"], ["user_id", 15], ["current_state_id", 25], ["created_at", "2022-01-28 23:04:39.045655"], ["updated_at", "2022-01-28 23:04:39.045655"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.2ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Renault"], ["user_id", 16], ["current_state_id", 25], ["created_at", "2022-01-28 23:04:39.054176"], ["updated_at", "2022-01-28 23:04:39.054176"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-29 00:20:56 +0100
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"expiry\\\":1644621656}}\""], ["updated_at", "2022-01-28 23:20:56.437827"], ["id", 15]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"}}\""], ["updated_at", "2022-01-28 23:20:56.511793"], ["id", 15]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 411ms (Views: 0.2ms | ActiveRecord: 8.7ms | Allocations: 25662)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-29 00:21:24 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"expiry\\\":1644621684}}\""], ["updated_at", "2022-01-28 23:21:24.412285"], ["id", 15]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"}}\""], ["updated_at", "2022-01-28 23:21:24.484975"], ["id", 15]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 387ms (Views: 0.1ms | ActiveRecord: 5.8ms | Allocations: 13180)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-29 00:21:42 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$Utel6HvJwM6lIuFLkY6aYOPkqO/tHXkfE1A42lIDkc7uU6fU0qsoq\\\",\\\"expiry\\\":1644621703}}\""], ["updated_at", "2022-01-28 23:21:43.154530"], ["id", 15]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"expiry\\\":1644621703,\\\"last_token\\\":\\\"$2a$10$Utel6HvJwM6lIuFLkY6aYOPkqO/tHXkfE1A42lIDkc7uU6fU0qsoq\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:43Z\\\"}}\""], ["updated_at", "2022-01-28 23:21:43.225294"], ["id", 15]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 389ms (Views: 0.1ms | ActiveRecord: 5.7ms | Allocations: 13305)


Started GET "/vehicles" for ::1 at 2022-01-29 00:22:39 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"}}\""], ["updated_at", "2022-01-28 23:22:39.577206"], ["id", 15]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 161ms (Views: 0.1ms | ActiveRecord: 6.8ms | Allocations: 19668)


Started GET "/vehicles" for ::1 at 2022-01-29 00:23:19 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 5ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 7202)


Started GET "/vehicles" for ::1 at 2022-01-29 00:23:25 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 65ms (Views: 0.2ms | ActiveRecord: 0.2ms | Allocations: 1383)


Started GET "/vehicles" for ::1 at 2022-01-29 00:23:41 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 63ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 1367)


Started GET "/vehicles" for ::1 at 2022-01-29 00:23:42 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 64ms (Views: 0.1ms | ActiveRecord: 0.3ms | Allocations: 1366)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-29 00:23:46 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$RLfUfJYbmw4GSC4JaHukcOF4FOMJy84.DmZmMQJfhYbBh55GakaU.\\\",\\\"expiry\\\":1644621827}}\""], ["updated_at", "2022-01-28 23:23:47.147570"], ["id", 15]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"expiry\\\":1644621827,\\\"last_token\\\":\\\"$2a$10$RLfUfJYbmw4GSC4JaHukcOF4FOMJy84.DmZmMQJfhYbBh55GakaU.\\\",\\\"updated_at\\\":\\\"2022-01-28T23:23:47Z\\\"}}\""], ["updated_at", "2022-01-28 23:23:47.218837"], ["id", 15]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 386ms (Views: 0.1ms | ActiveRecord: 5.2ms | Allocations: 13417)


Started GET "/vehicles" for ::1 at 2022-01-29 00:24:40 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:24:40Z\\\"}}\""], ["updated_at", "2022-01-28 23:24:40.702865"], ["id", 15]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 137ms (Views: 0.1ms | ActiveRecord: 3.8ms | Allocations: 10564)


Started GET "/vehicles" for ::1 at 2022-01-29 00:24:52 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 64ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 1375)


Started GET "/vehicles" for ::1 at 2022-01-29 00:25:06 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 63ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 1375)


Started GET "/vehicles" for ::1 at 2022-01-29 00:25:07 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 66ms (Views: 0.1ms | ActiveRecord: 0.2ms | Allocations: 1375)


Started GET "/vehicles" for ::1 at 2022-01-29 00:25:56 +0100
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.5ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:25:56Z\\\"}}\""], ["updated_at", "2022-01-28 23:25:56.694030"], ["id", 15]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 170ms (Views: 0.1ms | ActiveRecord: 11.2ms | Allocations: 32314)


Started GET "/vehicles" for ::1 at 2022-01-29 00:25:58 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:25:58Z\\\"}}\""], ["updated_at", "2022-01-28 23:25:58.330276"], ["id", 15]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 139ms (Views: 0.1ms | ActiveRecord: 3.5ms | Allocations: 10618)


Started GET "/vehicles" for ::1 at 2022-01-29 00:26:11 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:26:11Z\\\"}}\""], ["updated_at", "2022-01-28 23:26:11.760909"], ["id", 15]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 138ms (Views: 0.1ms | ActiveRecord: 4.3ms | Allocations: 10618)


Started GET "/vehicles" for ::1 at 2022-01-29 00:26:13 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:26:13Z\\\"}}\""], ["updated_at", "2022-01-28 23:26:13.377253"], ["id", 15]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 138ms (Views: 0.1ms | ActiveRecord: 4.0ms | Allocations: 10618)


Started GET "/vehicles" for ::1 at 2022-01-29 00:26:14 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:26:14Z\\\"}}\""], ["updated_at", "2022-01-28 23:26:14.252702"], ["id", 15]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 135ms (Views: 0.1ms | ActiveRecord: 4.1ms | Allocations: 10619)


Started GET "/vehicles" for ::1 at 2022-01-29 00:26:14 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.4ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:26:15Z\\\"}}\""], ["updated_at", "2022-01-28 23:26:15.004869"], ["id", 15]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 144ms (Views: 0.1ms | ActiveRecord: 4.6ms | Allocations: 10594)


Started GET "/vehicles" for ::1 at 2022-01-29 00:26:15 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 136ms (Views: 0.1ms | ActiveRecord: 2.5ms | Allocations: 9166)


Started GET "/vehicles" for ::1 at 2022-01-29 00:26:16 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:26:16Z\\\"}}\""], ["updated_at", "2022-01-28 23:26:16.265029"], ["id", 15]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 135ms (Views: 0.1ms | ActiveRecord: 3.6ms | Allocations: 10594)


Started GET "/vehicles" for ::1 at 2022-01-29 00:26:29 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:26:29Z\\\"}}\""], ["updated_at", "2022-01-28 23:26:29.746978"], ["id", 15]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 136ms (Views: 0.1ms | ActiveRecord: 3.1ms | Allocations: 10593)


Started GET "/vehicles" for ::1 at 2022-01-29 00:26:31 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.2ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:26:31Z\\\"}}\""], ["updated_at", "2022-01-28 23:26:31.411237"], ["id", 15]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 139ms (Views: 0.1ms | ActiveRecord: 4.5ms | Allocations: 10594)


Started GET "/vehicles" for ::1 at 2022-01-29 00:26:39 +0100
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.4ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:26:39Z\\\"}}\""], ["updated_at", "2022-01-28 23:26:39.363232"], ["id", 15]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 170ms (Views: 0.1ms | ActiveRecord: 10.8ms | Allocations: 32266)


Started GET "/vehicles" for ::1 at 2022-01-29 00:27:08 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.2ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:6:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"}}\""], ["updated_at", "2022-01-28 23:27:09.082913"], ["id", 15]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 136ms (Views: 0.1ms | ActiveRecord: 3.1ms | Allocations: 10570)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-30 14:15:01 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"expiry\\\":1644758101}}\""], ["updated_at", "2022-01-30 13:15:01.590988"], ["id", 15]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:15:01Z\\\"}}\""], ["updated_at", "2022-01-30 13:15:01.691269"], ["id", 15]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 541ms (Views: 0.2ms | ActiveRecord: 7.2ms | Allocations: 24374)


Started GET "/vehicles" for ::1 at 2022-01-30 14:15:45 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.6ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:8:in `index'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:15:46Z\\\"}}\""], ["updated_at", "2022-01-30 13:15:46.079621"], ["id", 15]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 122ms (Views: 0.1ms | ActiveRecord: 3.9ms | Allocations: 17216)


Started DELETE "/vehicles/13" for ::1 at 2022-01-30 14:15:56 +0100
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"13", "vehicle"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:38:in `set_vehicle'
Completed 404 Not Found in 4ms (ActiveRecord: 0.7ms | Allocations: 1975)


  
ActiveRecord::RecordNotFound (Couldn't find Vehicle with 'id'=13):
  
app/controllers/vehicles_controller.rb:38:in `set_vehicle'
Started DELETE "/vehicles/13" for ::1 at 2022-01-30 14:16:23 +0100
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"13", "vehicle"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.6ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:38:in `set_vehicle'
Completed 404 Not Found in 104ms (ActiveRecord: 8.9ms | Allocations: 14140)


  
ActiveRecord::RecordNotFound (Couldn't find Vehicle with 'id'=13):
  
app/controllers/vehicles_controller.rb:38:in `set_vehicle'
Started GET "/vehicles" for ::1 at 2022-01-30 14:16:29 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:8:in `index'
  [1m[36mState Load (0.6ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/vehicles_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:16:29Z\\\"}}\""], ["updated_at", "2022-01-30 13:16:29.929315"], ["id", 15]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 68ms (Views: 0.2ms | ActiveRecord: 10.7ms | Allocations: 20147)


Started DELETE "/vehicles/13" for ::1 at 2022-01-30 14:16:48 +0100
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"13", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.2ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
Completed 404 Not Found in 100ms (ActiveRecord: 5.3ms | Allocations: 12746)


  
ActiveRecord::RecordNotFound (Couldn't find Vehicle with 'id'=13):
  
app/controllers/vehicles_controller.rb:39:in `set_vehicle'
Started DELETE "/vehicles/13" for ::1 at 2022-01-30 14:17:43 +0100
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"13", "vehicle"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.4ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
Completed 404 Not Found in 104ms (ActiveRecord: 7.5ms | Allocations: 12718)


  
ActiveRecord::RecordNotFound (Couldn't find Vehicle with 'id'=13):
  
app/controllers/vehicles_controller.rb:39:in `set_vehicle'
Started DELETE "/vehicles/13" for ::1 at 2022-01-30 14:18:47 +0100
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"13", "vehicle"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.4ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:18:47Z\\\"}}\""], ["updated_at", "2022-01-30 13:18:47.881980"], ["id", 15]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 404 Not Found in 115ms (Views: 0.3ms | ActiveRecord: 8.1ms | Allocations: 20435)


Started DELETE "/vehicles/13" for ::1 at 2022-01-30 14:19:37 +0100
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"13", "vehicle"=>{}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.4ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
Completed 500 Internal Server Error in 101ms (ActiveRecord: 5.7ms | Allocations: 13289)


  
NoMethodError (undefined method `destroy' for nil:NilClass):
  
app/controllers/vehicles_controller.rb:28:in `destroy'
Started DELETE "/vehicles/13" for ::1 at 2022-01-30 14:19:44 +0100
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"13", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.7ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:19:44Z\\\"}}\""], ["updated_at", "2022-01-30 13:19:44.463978"], ["id", 15]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 404 Not Found in 115ms (Views: 0.2ms | ActiveRecord: 6.6ms | Allocations: 20399)


Started DELETE "/vehicles/11" for ::1 at 2022-01-30 14:20:27 +0100
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"11", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.4ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:44:in `set_vehicle'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/vehicles_controller.rb:34:in `destroy'
  [1m[36mVehicle Destroy (0.3ms)[0m  [1m[31mDELETE FROM "vehicles" WHERE "vehicles"."id" = $1[0m  [["id", 11]]
  ↳ app/controllers/vehicles_controller.rb:34:in `destroy'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/vehicles_controller.rb:34:in `destroy'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:20:28Z\\\"}}\""], ["updated_at", "2022-01-30 13:20:28.153815"], ["id", 15]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 126ms (Views: 0.5ms | ActiveRecord: 11.4ms | Allocations: 24968)


Started DELETE "/vehicles/11" for ::1 at 2022-01-30 14:22:14 +0100
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"11", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.7ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:40:in `set_vehicle'
Filter chain halted as :set_vehicle rendered or redirected
Completed 404 Not Found in 100ms (Views: 0.1ms | ActiveRecord: 5.6ms | Allocations: 12813)


Started GET "/vehicles" for ::1 at 2022-01-30 14:22:20 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.4ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:8:in `index'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.8ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:22:20Z\\\"}}\""], ["updated_at", "2022-01-30 13:22:20.944699"], ["id", 15]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 20ms (Views: 0.1ms | ActiveRecord: 4.8ms | Allocations: 9773)


Started DELETE "/vehicles/11" for ::1 at 2022-01-30 14:23:53 +0100
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"11", "vehicle"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.6ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:43:in `set_vehicle'
Filter chain halted as :set_vehicle rendered or redirected
Completed 404 Not Found in 106ms (Views: 0.2ms | ActiveRecord: 5.5ms | Allocations: 12793)


Started DELETE "/vehicles/11" for ::1 at 2022-01-30 14:24:11 +0100
Processing by VehiclesController#destroy as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "id"=>"11", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:43:in `set_vehicle'
Filter chain halted as :set_vehicle rendered or redirected
Completed 404 Not Found in 101ms (Views: 0.2ms | ActiveRecord: 4.7ms | Allocations: 12778)


Started POST "/vehicles" for ::1 at 2022-01-30 14:28:41 +0100
Error occurred while parsing request parameters.
Contents:

"vehicle": {
    {
        {
            "name": "bmwww",
        }
    }
Processing by VehiclesController#create as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Completed 400 Bad Request in 101ms (ActiveRecord: 3.6ms | Allocations: 12247)


  
ActionDispatch::Http::Parameters::ParseError (783: unexpected token at ': {
    {
        {
            "name": "bmwww",
        }
    }'):
  
app/controllers/vehicles_controller.rb:44:in `vehicle_params'
app/controllers/vehicles_controller.rb:11:in `create'
Started POST "/vehicles" for ::1 at 2022-01-30 14:30:48 +0100
Error occurred while parsing request parameters.
Contents:

"vehicle": {
    "name": "bmwww",
}
Processing by VehiclesController#create as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Completed 400 Bad Request in 2ms (ActiveRecord: 0.2ms | Allocations: 1367)


  
ActionDispatch::Http::Parameters::ParseError (783: unexpected token at ': {
    "name": "bmwww",
}'):
  
app/controllers/vehicles_controller.rb:44:in `vehicle_params'
app/controllers/vehicles_controller.rb:11:in `create'
Started POST "/vehicles" for ::1 at 2022-01-30 14:30:55 +0100
Error occurred while parsing request parameters.
Contents:

"vehicle" {
    "name": "bmwww",
}
Processing by VehiclesController#create as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Completed 400 Bad Request in 4ms (ActiveRecord: 0.3ms | Allocations: 1366)


  
ActionDispatch::Http::Parameters::ParseError (783: unexpected token at '{
    "name": "bmwww",
}'):
  
app/controllers/vehicles_controller.rb:44:in `vehicle_params'
app/controllers/vehicles_controller.rb:11:in `create'
Started POST "/vehicles" for ::1 at 2022-01-30 14:34:53 +0100
Processing by VehiclesController#create as JSON
  Parameters: {"vehicle"=>{"name"=>"bmwww"}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/vehicles_controller.rb:12:in `create'
  [1m[36mVehicle Create (0.5ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "bmwww"], ["user_id", 15], ["current_state_id", 25], ["created_at", "2022-01-30 13:34:53.497940"], ["updated_at", "2022-01-30 13:34:53.497940"]]
  ↳ app/controllers/vehicles_controller.rb:12:in `create'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/vehicles_controller.rb:12:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:34:53Z\\\"}}\""], ["updated_at", "2022-01-30 13:34:53.512845"], ["id", 15]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 49ms (Views: 0.1ms | ActiveRecord: 11.1ms | Allocations: 20582)


Started POST "/vehicles" for ::1 at 2022-01-30 14:37:14 +0100
Processing by VehiclesController#create as JSON
  Parameters: {"vehicle"=>{"name"=>"bmwww", "current_state_id"=>26}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/vehicles_controller.rb:12:in `create'
  [1m[36mVehicle Create (0.2ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "bmwww"], ["user_id", 15], ["current_state_id", 26], ["created_at", "2022-01-30 13:37:14.154149"], ["updated_at", "2022-01-30 13:37:14.154149"]]
  ↳ app/controllers/vehicles_controller.rb:12:in `create'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/vehicles_controller.rb:12:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:37:14Z\\\"}}\""], ["updated_at", "2022-01-30 13:37:14.170031"], ["id", 15]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 26ms (Views: 0.1ms | ActiveRecord: 6.1ms | Allocations: 12201)


Started POST "/vehicles" for ::1 at 2022-01-30 14:39:48 +0100
Processing by VehiclesController#create as JSON
  Parameters: {"vehicle"=>{"name"=>"bmwww", "current_state_id"=>26}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.5ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/vehicles_controller.rb:12:in `create'
  [1m[36mVehicle Create (0.5ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "bmwww"], ["user_id", 15], ["current_state_id", 26], ["created_at", "2022-01-30 13:39:48.882749"], ["updated_at", "2022-01-30 13:39:48.882749"]]
  ↳ app/controllers/vehicles_controller.rb:12:in `create'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/vehicles_controller.rb:12:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (1.0ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:39:48Z\\\"}}\""], ["updated_at", "2022-01-30 13:39:48.905998"], ["id", 15]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 39ms (Views: 0.2ms | ActiveRecord: 8.4ms | Allocations: 12020)


Started PATCH "/vehicles/15" for ::1 at 2022-01-30 14:40:37 +0100
Processing by VehiclesController#update as JSON
  Parameters: {"vehicle"=>{"name"=>"toto", "current_state_id"=>28}, "id"=>"15"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
  [1m[35m (1.9ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:17:in `validate_state_order'
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:18:in `validate_state_order'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.9ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:40:37Z\\\"}}\""], ["updated_at", "2022-01-30 13:40:37.784665"], ["id", 15]]
  [1m[35m (4.4ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 69ms (Views: 0.2ms | ActiveRecord: 10.8ms | Allocations: 20027)


Started PATCH "/vehicles/15" for ::1 at 2022-01-30 14:41:20 +0100
Processing by VehiclesController#update as JSON
  Parameters: {"vehicle"=>{"name"=>"toto", "current_state_id"=>28}, "id"=>"15"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.2ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:17:in `validate_state_order'
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:18:in `validate_state_order'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:41:20Z\\\"}}\""], ["updated_at", "2022-01-30 13:41:20.332746"], ["id", 15]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 148ms (Views: 0.1ms | ActiveRecord: 14.5ms | Allocations: 32366)


Started PATCH "/vehicles/15" for ::1 at 2022-01-30 14:41:38 +0100
Processing by VehiclesController#update as JSON
  Parameters: {"vehicle"=>{"name"=>"toto", "current_state_id"=>28}, "id"=>"15"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:17:in `validate_state_order'
  [1m[36mState Load (0.9ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:18:in `validate_state_order'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:41:38Z\\\"}}\""], ["updated_at", "2022-01-30 13:41:38.388939"], ["id", 15]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 148ms (Views: 0.1ms | ActiveRecord: 16.5ms | Allocations: 32320)


Started PATCH "/vehicles/15" for ::1 at 2022-01-30 14:41:50 +0100
Processing by VehiclesController#update as JSON
  Parameters: {"vehicle"=>{"name"=>"toto", "current_state_id"=>28}, "id"=>"15"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.4ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:17:in `validate_state_order'
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:18:in `validate_state_order'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:41:50Z\\\"}}\""], ["updated_at", "2022-01-30 13:41:50.436014"], ["id", 15]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 153ms (Views: 0.2ms | ActiveRecord: 12.7ms | Allocations: 33449)


Started PATCH "/vehicles/15" for ::1 at 2022-01-30 14:42:06 +0100
Processing by VehiclesController#update as JSON
  Parameters: {"vehicle"=>{"name"=>"toto", "current_state_id"=>27}, "id"=>"15"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 26], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:17:in `validate_state_order'
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 27], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:18:in `validate_state_order'
  [1m[36mVehicle Update (0.4ms)[0m  [1m[33mUPDATE "vehicles" SET "name" = $1, "current_state_id" = $2, "updated_at" = $3 WHERE "vehicles"."id" = $4[0m  [["name", "toto"], ["current_state_id", 27], ["updated_at", "2022-01-30 13:42:06.911759"], ["id", 15]]
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:42:06Z\\\"}}\""], ["updated_at", "2022-01-30 13:42:06.925055"], ["id", 15]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 29ms (Views: 0.1ms | ActiveRecord: 6.7ms | Allocations: 14439)


Started PATCH "/vehicles/15" for ::1 at 2022-01-30 14:42:18 +0100
Processing by VehiclesController#update as JSON
  Parameters: {"vehicle"=>{"name"=>"toto", "current_state_id"=>25}, "id"=>"15"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.3ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:39:in `set_vehicle'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 27], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:17:in `validate_state_order'
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 25], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:18:in `validate_state_order'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/vehicles_controller.rb:24:in `update'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:42:18Z\\\"}}\""], ["updated_at", "2022-01-30 13:42:18.084566"], ["id", 15]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 25ms (Views: 0.1ms | ActiveRecord: 5.1ms | Allocations: 13570)


Started POST "/vehicles" for ::1 at 2022-01-30 14:42:31 +0100
Processing by VehiclesController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Completed 400 Bad Request in 2ms (ActiveRecord: 0.2ms | Allocations: 1432)


  
ActionController::ParameterMissing (param is missing or the value is empty: vehicle):
  
app/controllers/vehicles_controller.rb:44:in `vehicle_params'
app/controllers/vehicles_controller.rb:11:in `create'
Started GET "/vehicles" for ::1 at 2022-01-30 14:42:39 +0100
Processing by VehiclesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "vehicle"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mVehicle Load (0.6ms)[0m  [1m[34mSELECT "vehicles".* FROM "vehicles" WHERE "vehicles"."user_id" = $1[0m  [["user_id", 15]]
  ↳ app/controllers/vehicles_controller.rb:7:in `index'
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" IN ($1, $2, $3)[0m  [["id", 25], ["id", 26], ["id", 27]]
  ↳ app/controllers/vehicles_controller.rb:7:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:42:39Z\\\"}}\""], ["updated_at", "2022-01-30 13:42:39.274762"], ["id", 15]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 28ms (Views: 0.1ms | ActiveRecord: 5.2ms | Allocations: 11066)


Started GET "/states" for ::1 at 2022-01-30 14:50:57 +0100
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mState Load (1.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:7:in `index'
Completed 200 OK in 11ms (Views: 6.7ms | ActiveRecord: 5.0ms | Allocations: 7074)


Started POST "/states" for ::1 at 2022-01-30 14:56:33 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"bmwww", "order"=>26}}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `authorize_only_admin!'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 26)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.6ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 13:56:33.535250', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 26)[0m
  ↳ app/controllers/states_controller.rb:16:in `create'
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "bmwww"], ["order", 26], ["created_at", "2022-01-30 13:56:33.532769"], ["updated_at", "2022-01-30 13:56:33.532769"]]
  ↳ app/controllers/states_controller.rb:16:in `create'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.6ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 29], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:16:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:56:33Z\\\"}}\""], ["updated_at", "2022-01-30 13:56:33.554005"], ["id", 15]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 155ms (Views: 0.4ms | ActiveRecord: 17.5ms | Allocations: 30015)


Started GET "/states" for ::1 at 2022-01-30 14:56:42 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:7:in `index'
Completed 200 OK in 6ms (Views: 4.7ms | ActiveRecord: 0.4ms | Allocations: 3987)


Started GET "/states" for ::1 at 2022-01-30 14:57:10 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:7:in `index'
Completed 200 OK in 13ms (Views: 11.7ms | ActiveRecord: 0.5ms | Allocations: 3989)


Started POST "/states" for ::1 at 2022-01-30 14:57:50 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>29}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `authorize_only_admin!'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 29)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.5ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 13:57:50.590189', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 29)[0m
  ↳ app/controllers/states_controller.rb:16:in `create'
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "oki"], ["order", 29], ["created_at", "2022-01-30 13:57:50.588390"], ["updated_at", "2022-01-30 13:57:50.588390"]]
  ↳ app/controllers/states_controller.rb:16:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 30], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:16:in `create'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:57:50Z\\\"}}\""], ["updated_at", "2022-01-30 13:57:50.614275"], ["id", 15]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 38ms (Views: 0.6ms | ActiveRecord: 8.2ms | Allocations: 14768)


Started GET "/states" for ::1 at 2022-01-30 14:57:54 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:7:in `index'
Completed 200 OK in 5ms (Views: 4.7ms | ActiveRecord: 0.4ms | Allocations: 4075)


Started POST "/states" for ::1 at 2022-01-30 14:58:24 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `authorize_only_admin!'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:16:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 15], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 15], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"s34ZNEqg_rDx96GIdAqQeg\\\":{\\\"token\\\":\\\"$2a$10$nH/n0NuNNWRZpB3FUNo3X.FR.7zZjq3XHuBEDVd7lPCHr0k.qwE.q\\\",\\\"expiry\\\":1644621656,\\\"last_token\\\":\\\"$2a$10$mDaj67jzWMBBRoxxH/fSkeaIzxW0hYlL1THTJG2N.Q.SD1od63a2a\\\",\\\"updated_at\\\":\\\"2022-01-28T23:20:56Z\\\"},\\\"8R1nx8gGqJhJw4qny0-0BQ\\\":{\\\"token\\\":\\\"$2a$10$KhwuVsdARUnzw5S7wTwj7.vqiGh4zDX28jtKLski.BDpyyjRFABfC\\\",\\\"expiry\\\":1644621684,\\\"last_token\\\":\\\"$2a$10$wWe8LXouBixKYZmFkqUvRupFKjaUBosLr.58OJKbcASot7zuxPrzC\\\",\\\"updated_at\\\":\\\"2022-01-28T23:21:24Z\\\"},\\\"HXPG5hmsVONbW5sElq5Gsw\\\":{\\\"token\\\":\\\"$2a$10$ozig3CCUGaA/EhovY6LH3e9Dz92mFzb/pu3eLOt7fFOe6QJy3N1Ni\\\",\\\"expiry\\\":1644621759,\\\"last_token\\\":\\\"$2a$10$QWAt2aeIInJJwsu3Xm5tBuCFfZhMjrGUklpuOdacZEEi6zJYekNHa\\\",\\\"updated_at\\\":\\\"2022-01-28T23:22:39Z\\\"},\\\"v66Tjx0plW9EST9X7B7Psg\\\":{\\\"token\\\":\\\"$2a$10$ReaZrRwqQj7AcfaW7DE1MO0FmFru8i.Cytmf3yGgphpdpwmkd4wKy\\\",\\\"expiry\\\":1644621880,\\\"last_token\\\":\\\"$2a$10$TtSlslXJ6VCLBgjfXg5W7ubf98wxniTzTE8F9Yp1M887vDSrXEsyO\\\",\\\"updated_at\\\":\\\"2022-01-28T23:27:09Z\\\"},\\\"Ja49DvfriZI0cXTcphfOKA\\\":{\\\"token\\\":\\\"$2a$10$CbCPWOINILwmBFeXJuNXDOcwOw7vyT2t.ffMTLzI5ZggQyxLa8msO\\\",\\\"expiry\\\":1644758101,\\\"last_token\\\":\\\"$2a$10$AsTv6SVixBa9jMv37k0sy.SuA/UgBBvL7DofsEk7sOKYeyVwrdqEK\\\",\\\"updated_at\\\":\\\"2022-01-30T13:58:24Z\\\"}}\""], ["updated_at", "2022-01-30 13:58:24.757899"], ["id", 15]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 25ms (Views: 0.1ms | ActiveRecord: 5.0ms | Allocations: 16870)


Started GET "/states" for ::1 at 2022-01-30 15:06:29 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mState Load (1.0ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:7:in `index'
Completed 200 OK in 10ms (Views: 7.6ms | ActiveRecord: 1.0ms | Allocations: 6896)


  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (5011.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "xpark_backend_development"[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata"."value" FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1[0m  [["key", "environment"]]
  [1m[35m (25.1ms)[0m  [1m[35mDROP DATABASE IF EXISTS "xpark_backend_development"[0m
  [1m[35m (23.7ms)[0m  [1m[35mDROP DATABASE IF EXISTS "xpark_backend_test"[0m
  [1m[35m (63.7ms)[0m  [1m[35mCREATE DATABASE "xpark_backend_development" ENCODING = 'unicode'[0m
  [1m[35m (57.3ms)[0m  [1m[35mCREATE DATABASE "xpark_backend_test" ENCODING = 'unicode'[0m
  [1m[35m (9.3ms)[0m  [1m[35mCREATE TABLE "schema_migrations" ("version" character varying NOT NULL PRIMARY KEY)[0m
  [1m[35m (7.2ms)[0m  [1m[35mCREATE TABLE "ar_internal_metadata" ("key" character varying NOT NULL PRIMARY KEY, "value" character varying, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6259495107986884680)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to DeviseTokenAuthCreateUsers (20220128154721)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (8.6ms)[0m  [1m[35mCREATE TABLE "users" ("id" bigserial primary key, "provider" character varying DEFAULT 'email' NOT NULL, "uid" character varying DEFAULT '' NOT NULL, "encrypted_password" character varying DEFAULT '' NOT NULL, "reset_password_token" character varying, "reset_password_sent_at" timestamp, "allow_password_change" boolean DEFAULT FALSE, "remember_created_at" timestamp, "confirmation_token" character varying, "confirmed_at" timestamp, "confirmation_sent_at" timestamp, "unconfirmed_email" character varying, "name" character varying, "nickname" character varying, "image" character varying, "email" character varying, "tokens" json, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.9ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_email" ON "users"  ("email")[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_uid_and_provider" ON "users"  ("uid", "provider")[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_reset_password_token" ON "users"  ("reset_password_token")[0m
  [1m[35m (2.4ms)[0m  [1m[35mCREATE UNIQUE INDEX  "index_users_on_confirmation_token" ON "users"  ("confirmation_token")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.6ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128154721"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Migrating to AddRoleToUsers (20220128161614)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "users" ADD "role" integer[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128161614"]]
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateStates (20220128204110)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (5.7ms)[0m  [1m[35mCREATE TABLE "states" ("id" bigserial primary key, "name" character varying, "order" integer, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.4ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128204110"]]
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
Migrating to CreateVehicles (20220128204223)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (5.4ms)[0m  [1m[35mCREATE TABLE "vehicles" ("id" bigserial primary key, "name" character varying, "user_id" bigint, "current_state_id" bigint, "created_at" timestamp(6) NOT NULL, "updated_at" timestamp(6) NOT NULL)[0m
  [1m[35m (2.1ms)[0m  [1m[35mCREATE  INDEX  "index_vehicles_on_user_id" ON "vehicles"  ("user_id")[0m
  [1m[35m (2.2ms)[0m  [1m[35mCREATE  INDEX  "index_vehicles_on_current_state_id" ON "vehicles"  ("current_state_id")[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128204223"]]
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
Migrating to SetDefaultValue (20220128211623)
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (0.4ms)[0m  [1m[35mALTER TABLE "users" ALTER COLUMN "role" SET DEFAULT 1[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220128211623"]]
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.2ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mActiveRecord::InternalMetadata Create (0.4ms)[0m  [1m[32mINSERT INTO "ar_internal_metadata" ("key", "value", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "key"[0m  [["key", "environment"], ["value", "development"], ["created_at", "2022-01-30 14:07:13.349751"], ["updated_at", "2022-01-30 14:07:13.349751"]]
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT pg_advisory_unlock(6259495107986884680)[0m
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.8ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.7ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_1@gmail.com"], ["encrypted_password", "$2a$12$DsnJNQb7TqC4JeuDmiQRaupwOFVVuemtAuLOHag3HyJOih8FLVsLi"], ["name", "regular_1_name"], ["nickname", "regular_1_nickname"], ["email", "regular_1@gmail.com"], ["created_at", "2022-01-30 14:07:20.138308"], ["updated_at", "2022-01-30 14:07:20.138308"]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.4ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.6ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5, $6, $7) RETURNING "id"[0m  [["uid", "regular_2@gmail.com"], ["encrypted_password", "$2a$12$65Lo7QZPNe6TZSRS5BLeuu07bcu6TpZJIZUAHyDXaXYMGN1x7wJ36"], ["name", "regular_2_name"], ["nickname", "regular_2_nickname"], ["email", "regular_2@gmail.com"], ["created_at", "2022-01-30 14:07:20.408316"], ["updated_at", "2022-01-30 14:07:20.408316"]]
  [1m[35m (3.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.5ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_1@gmail.com"], ["encrypted_password", "$2a$12$sY80ybzwUbSU.dctR/yB5eQPho9Zw4TU55iCwmMgqSUoIj/E7zW.W"], ["name", "admin_1_name"], ["nickname", "admin_1_nickname"], ["email", "admin_1@gmail.com"], ["created_at", "2022-01-30 14:07:20.686583"], ["updated_at", "2022-01-30 14:07:20.686583"], ["role", 0]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Exists? (0.5ms)[0m  [1m[34mSELECT 1 AS one FROM "users" WHERE LOWER("users"."email") = LOWER($1) AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_2@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
  [1m[36mUser Create (0.4ms)[0m  [1m[32mINSERT INTO "users" ("uid", "encrypted_password", "name", "nickname", "email", "created_at", "updated_at", "role") VALUES ($1, $2, $3, $4, $5, $6, $7, $8) RETURNING "id"[0m  [["uid", "admin_2@gmail.com"], ["encrypted_password", "$2a$12$z8yBhguPFmbTSGqDpGwg6e76SPYyoKI78rD6OJyv8iTQozOLaxVQC"], ["name", "admin_2_name"], ["nickname", "admin_2_nickname"], ["email", "admin_2@gmail.com"], ["created_at", "2022-01-30 14:07:20.962362"], ["updated_at", "2022-01-30 14:07:20.962362"], ["role", 0]]
  [1m[35m (2.6ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.5ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:07:20.980020', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Designed"], ["order", 1], ["created_at", "2022-01-30 14:07:20.978644"], ["updated_at", "2022-01-30 14:07:20.978644"]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 2)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:07:20.991861', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 2)[0m
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Assembled"], ["order", 2], ["created_at", "2022-01-30 14:07:20.990687"], ["updated_at", "2022-01-30 14:07:20.990687"]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 2], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:07:21.004321', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Painted"], ["order", 3], ["created_at", "2022-01-30 14:07:21.002932"], ["updated_at", "2022-01-30 14:07:21.002932"]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 4)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:07:21.016245', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 4)[0m
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "Tested"], ["order", 4], ["created_at", "2022-01-30 14:07:21.015104"], ["updated_at", "2022-01-30 14:07:21.015104"]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 4], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.5ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "BMW"], ["user_id", 1], ["current_state_id", 1], ["created_at", "2022-01-30 14:07:21.035799"], ["updated_at", "2022-01-30 14:07:21.035799"]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.3ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Toyota"], ["user_id", 1], ["current_state_id", 1], ["created_at", "2022-01-30 14:07:21.041746"], ["updated_at", "2022-01-30 14:07:21.041746"]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.3ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Mercedes"], ["user_id", 2], ["current_state_id", 1], ["created_at", "2022-01-30 14:07:21.047295"], ["updated_at", "2022-01-30 14:07:21.047295"]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.5ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Seat"], ["user_id", 2], ["current_state_id", 1], ["created_at", "2022-01-30 14:07:21.052910"], ["updated_at", "2022-01-30 14:07:21.052910"]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.4ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Clio"], ["user_id", 3], ["current_state_id", 1], ["created_at", "2022-01-30 14:07:21.064225"], ["updated_at", "2022-01-30 14:07:21.064225"]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."order" = $1 LIMIT $2[0m  [["order", 1], ["LIMIT", 1]]
  ↳ app/models/vehicle.rb:24:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mVehicle Create (0.4ms)[0m  [1m[32mINSERT INTO "vehicles" ("name", "user_id", "current_state_id", "created_at", "updated_at") VALUES ($1, $2, $3, $4, $5) RETURNING "id"[0m  [["name", "Renault"], ["user_id", 4], ["current_state_id", 1], ["created_at", "2022-01-30 14:07:21.070466"], ["updated_at", "2022-01-30 14:07:21.070466"]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-30 15:08:09 +0100
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"regular_1@gmail.comm", "password"=>"[FILTERED]", "session"=>{"email"=>"regular_1@gmail.comm", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.comm"], ["provider", "email"], ["LIMIT", 1]]
Completed 401 Unauthorized in 13ms (Views: 0.2ms | ActiveRecord: 2.9ms | Allocations: 9395)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-30 15:08:18 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"regular_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"regular_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"Di5Nveme05iKgTBSo-m5mQ\\\":{\\\"token\\\":\\\"$2a$10$.wkLcE9eCdif745FVT6ive/mXeyguzmRkmeRUaIPdfMSLm0K5RxcS\\\",\\\"expiry\\\":1644761298}}\""], ["updated_at", "2022-01-30 14:08:18.566989"], ["id", 1]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"Di5Nveme05iKgTBSo-m5mQ\\\":{\\\"token\\\":\\\"$2a$10$XwTwSRJP2D/W/8MfJq.VEeur1hX11QgFURX9LO8MTdn930VGBv82m\\\",\\\"expiry\\\":1644761298,\\\"last_token\\\":\\\"$2a$10$.wkLcE9eCdif745FVT6ive/mXeyguzmRkmeRUaIPdfMSLm0K5RxcS\\\",\\\"updated_at\\\":\\\"2022-01-30T14:08:18Z\\\"}}\""], ["updated_at", "2022-01-30 14:08:18.672404"], ["id", 1]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 559ms (Views: 0.2ms | ActiveRecord: 9.3ms | Allocations: 23644)


Started GET "/states" for ::1 at 2022-01-30 15:09:37 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mState Load (0.6ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:7:in `index'
Completed 200 OK in 11ms (Views: 8.5ms | ActiveRecord: 3.3ms | Allocations: 3688)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:10:00 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:12:in `authorize_only_admin!'
Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.3ms | Allocations: 1381)


  
NoMethodError (undefined method `admin?' for nil:NilClass):
  
app/controllers/application_controller.rb:12:in `authorize_only_admin!'
Started PATCH "/states/1" for ::1 at 2022-01-30 15:10:53 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  ↳ (byebug):1:in `authorize_only_admin!'
  [1m[36mCACHE User Load (0.0ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  ↳ app/controllers/application_controller.rb:13:in `authorize_only_admin!'
Completed 500 Internal Server Error in 129551ms (ActiveRecord: 5.6ms | Allocations: 64185)


  
NoMethodError (undefined method `admin?' for nil:NilClass):
  
app/controllers/application_controller.rb:13:in `authorize_only_admin!'
Started PATCH "/states/1" for ::1 at 2022-01-30 15:13:05 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 26ms (Views: 0.2ms | ActiveRecord: 4.3ms | Allocations: 12012)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:13:41 +0100
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 32ms (Views: 0.2ms | ActiveRecord: 5.0ms | Allocations: 19373)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-30 15:13:50 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"regular_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"regular_1@gmail.com", "password"=>"[FILTERED]"}}
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 430)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-30 15:16:09 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"regular_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"regular_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "regular_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"Di5Nveme05iKgTBSo-m5mQ\\\":{\\\"token\\\":\\\"$2a$10$XwTwSRJP2D/W/8MfJq.VEeur1hX11QgFURX9LO8MTdn930VGBv82m\\\",\\\"expiry\\\":1644761298,\\\"last_token\\\":\\\"$2a$10$.wkLcE9eCdif745FVT6ive/mXeyguzmRkmeRUaIPdfMSLm0K5RxcS\\\",\\\"updated_at\\\":\\\"2022-01-30T14:08:18Z\\\"},\\\"FUxPStDfSfK9vEab6kUYlg\\\":{\\\"token\\\":\\\"$2a$10$ODCcYu10CVTF9O2IsPjl4.AIwOLw6YRvE6zkPhK.q5tBdKuJEFt9.\\\",\\\"expiry\\\":1644761770}}\""], ["updated_at", "2022-01-30 14:16:10.286860"], ["id", 1]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"Di5Nveme05iKgTBSo-m5mQ\\\":{\\\"token\\\":\\\"$2a$10$XwTwSRJP2D/W/8MfJq.VEeur1hX11QgFURX9LO8MTdn930VGBv82m\\\",\\\"expiry\\\":1644761298,\\\"last_token\\\":\\\"$2a$10$.wkLcE9eCdif745FVT6ive/mXeyguzmRkmeRUaIPdfMSLm0K5RxcS\\\",\\\"updated_at\\\":\\\"2022-01-30T14:08:18Z\\\"},\\\"FUxPStDfSfK9vEab6kUYlg\\\":{\\\"token\\\":\\\"$2a$10$nfaqgsaar5MhGMskhpQGg.CCmdFCjL/jaoISAiIIpFNKSzLGx4kYa\\\",\\\"expiry\\\":1644761770,\\\"last_token\\\":\\\"$2a$10$ODCcYu10CVTF9O2IsPjl4.AIwOLw6YRvE6zkPhK.q5tBdKuJEFt9.\\\",\\\"updated_at\\\":\\\"2022-01-30T14:16:10Z\\\"}}\""], ["updated_at", "2022-01-30 14:16:10.388847"], ["id", 1]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 586ms (Views: 0.2ms | ActiveRecord: 14.1ms | Allocations: 24325)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:16:49 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 3ms (Views: 0.1ms | ActiveRecord: 0.4ms | Allocations: 1462)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:17:06 +0100
  [1m[35m (0.9ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 28ms (Views: 0.2ms | ActiveRecord: 4.7ms | Allocations: 19373)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:17:40 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 22ms (Views: 0.2ms | ActiveRecord: 4.2ms | Allocations: 11982)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:17:59 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "regular_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:41:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:26:in `update'
Completed 500 Internal Server Error in 234ms (ActiveRecord: 5.1ms | Allocations: 82830)


  
NameError (undefined local variable or method `state' for #<StatesController:0x00007f3ab8017a08>
Did you mean?  @state
               status
               stale?):
  
app/controllers/states_controller.rb:29:in `update'
Started PATCH "/states/1" for ::1 at 2022-01-30 15:18:26 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "regular_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:41:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:26:in `update'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"Di5Nveme05iKgTBSo-m5mQ\\\":{\\\"token\\\":\\\"$2a$10$XwTwSRJP2D/W/8MfJq.VEeur1hX11QgFURX9LO8MTdn930VGBv82m\\\",\\\"expiry\\\":1644761298,\\\"last_token\\\":\\\"$2a$10$.wkLcE9eCdif745FVT6ive/mXeyguzmRkmeRUaIPdfMSLm0K5RxcS\\\",\\\"updated_at\\\":\\\"2022-01-30T14:08:18Z\\\"},\\\"FUxPStDfSfK9vEab6kUYlg\\\":{\\\"token\\\":\\\"$2a$10$nfaqgsaar5MhGMskhpQGg.CCmdFCjL/jaoISAiIIpFNKSzLGx4kYa\\\",\\\"expiry\\\":1644761770,\\\"last_token\\\":\\\"$2a$10$ODCcYu10CVTF9O2IsPjl4.AIwOLw6YRvE6zkPhK.q5tBdKuJEFt9.\\\",\\\"updated_at\\\":\\\"2022-01-30T14:18:26Z\\\"}}\""], ["updated_at", "2022-01-30 14:18:26.533489"], ["id", 1]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 173ms (Views: 0.2ms | ActiveRecord: 12.7ms | Allocations: 25933)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:18:41 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "regular_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authorize_only_admin! rendered or redirected
Completed 401 Unauthorized in 113ms (Views: 0.1ms | ActiveRecord: 4.7ms | Allocations: 12099)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:19:35 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "regular_1@gmail.com"], ["LIMIT", 1]]
Filter chain halted as :authorize_only_admin! rendered or redirected
Completed 401 Unauthorized in 124ms (Views: 0.6ms | ActiveRecord: 4.2ms | Allocations: 12056)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-30 15:20:14 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]"}}
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 2ms (Views: 0.2ms | ActiveRecord: 0.0ms | Allocations: 430)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-30 15:20:24 +0100
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]"}}
Filter chain halted as :authenticate_api_user! rendered or redirected
Completed 401 Unauthorized in 1ms (Views: 0.3ms | ActiveRecord: 0.0ms | Allocations: 197)


Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-30 15:21:09 +0100
  
SyntaxError (/home/seif/CV/xpark/xpark_backend/app/controllers/application_controller.rb:16: syntax error, unexpected end-of-input, expecting `end'):
  
app/controllers/application_controller.rb:16: syntax error, unexpected end-of-input, expecting `end'
app/controllers/application_controller.rb:16: syntax error, unexpected end-of-input, expecting `end'
Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-30 15:22:09 +0100
Started POST "/api/v1/auth/sign_in" for ::1 at 2022-01-30 15:22:45 +0100
  [1m[35m (0.8ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by DeviseTokenAuth::SessionsController#create as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "session"=>{"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]"}}
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."email" = $1 AND "users"."provider" = $2 LIMIT $3[0m  [["email", "admin_1@gmail.com"], ["provider", "email"], ["LIMIT", 1]]
[31mUnpermitted parameter: :session[0m
[31mUnpermitted parameter: :session[0m
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"expiry\\\":1644762166}}\""], ["updated_at", "2022-01-30 14:22:46.055882"], ["id", 3]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (1.1ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:22:46Z\\\"}}\""], ["updated_at", "2022-01-30 14:22:46.165943"], ["id", 3]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 592ms (Views: 0.2ms | ActiveRecord: 14.7ms | Allocations: 25674)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:24:38 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:24:38Z\\\"}}\""], ["updated_at", "2022-01-30 14:24:38.722937"], ["id", 3]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 167ms (Views: 0.2ms | ActiveRecord: 10.3ms | Allocations: 31686)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:24:50 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"order"=>500}, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.9ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:24:50Z\\\"}}\""], ["updated_at", "2022-01-30 14:24:50.103830"], ["id", 3]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 29ms (Views: 0.2ms | ActiveRecord: 6.2ms | Allocations: 11646)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:25:02 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>5}, "id"=>"1"}
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.8ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:25:02Z\\\"}}\""], ["updated_at", "2022-01-30 14:25:02.167681"], ["id", 3]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 49ms (Views: 0.3ms | ActiveRecord: 6.7ms | Allocations: 11632)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:25:07 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"oki", "order"=>4}, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update (0.5ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "order" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "oki"], ["order", 4], ["updated_at", "2022-01-30 14:25:07.629364"], ["id", 1]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mState Load (0.5ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:25:07Z\\\"}}\""], ["updated_at", "2022-01-30 14:25:07.647647"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 33ms (Views: 0.5ms | ActiveRecord: 8.1ms | Allocations: 13918)


Started GET "/states" for ::1 at 2022-01-30 15:26:01 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (1.1ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:26:01Z\\\"}}\""], ["updated_at", "2022-01-30 14:26:01.982446"], ["id", 3]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 26ms (Views: 2.4ms | ActiveRecord: 5.5ms | Allocations: 9458)


Started POST "/states" for ::1 at 2022-01-30 15:27:36 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"not", "order"=>100}}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:27:37Z\\\"}}\""], ["updated_at", "2022-01-30 14:27:37.183494"], ["id", 3]]
  [1m[35m (2.7ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 154ms (Views: 0.2ms | ActiveRecord: 13.4ms | Allocations: 24912)


Started POST "/states" for ::1 at 2022-01-30 15:27:57 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"not", "order"=>5}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 5)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:27:57.321490', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 5)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "not"], ["order", 5], ["created_at", "2022-01-30 14:27:57.318466"], ["updated_at", "2022-01-30 14:27:57.318466"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.8ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:27:57Z\\\"}}\""], ["updated_at", "2022-01-30 14:27:57.344900"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 179ms (Views: 0.7ms | ActiveRecord: 15.6ms | Allocations: 28875)


Started GET "/states" for ::1 at 2022-01-30 15:28:16 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:28:16Z\\\"}}\""], ["updated_at", "2022-01-30 14:28:16.939652"], ["id", 3]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 27ms (Views: 3.4ms | ActiveRecord: 4.5ms | Allocations: 9563)


Started POST "/states" for ::1 at 2022-01-30 15:28:45 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"not", "order"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:28:45.388685', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 1)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "not"], ["order", 1], ["created_at", "2022-01-30 14:28:45.387366"], ["updated_at", "2022-01-30 14:28:45.387366"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 6], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:28:45Z\\\"}}\""], ["updated_at", "2022-01-30 14:28:45.416111"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 40ms (Views: 0.4ms | ActiveRecord: 7.4ms | Allocations: 14962)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:29:05 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"Designed", "order"=>1}, "id"=>"1"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update (0.5ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "order" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "Designed"], ["order", 1], ["updated_at", "2022-01-30 14:29:05.241255"], ["id", 1]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" = 1)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mState Load (0.9ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (1.0ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:29:05Z\\\"}}\""], ["updated_at", "2022-01-30 14:29:05.260157"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 33ms (Views: 0.3ms | ActiveRecord: 8.5ms | Allocations: 13976)


Started GET "/states" for ::1 at 2022-01-30 15:29:09 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:29:09Z\\\"}}\""], ["updated_at", "2022-01-30 14:29:09.319222"], ["id", 3]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 20ms (Views: 1.8ms | ActiveRecord: 4.5ms | Allocations: 9670)


Started PATCH "/states/1" for ::1 at 2022-01-30 15:29:43 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"Designed", "order"=>5}, "id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "order" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["order", 5], ["updated_at", "2022-01-30 14:29:43.453495"], ["id", 1]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" = 5)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:29:43Z\\\"}}\""], ["updated_at", "2022-01-30 14:29:43.470712"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 30ms (Views: 0.5ms | ActiveRecord: 7.4ms | Allocations: 13741)


Started GET "/states" for ::1 at 2022-01-30 15:29:51 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:29:51Z\\\"}}\""], ["updated_at", "2022-01-30 14:29:51.510174"], ["id", 3]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 22ms (Views: 2.6ms | ActiveRecord: 4.2ms | Allocations: 9670)


Started POST "/states" for ::1 at 2022-01-30 15:31:00 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"xxxxxxxx", "order"=>3}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:31:00.628237', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 3)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "xxxxxxxx"], ["order", 3], ["created_at", "2022-01-30 14:31:00.625705"], ["updated_at", "2022-01-30 14:31:00.625705"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 7], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:31:00Z\\\"}}\""], ["updated_at", "2022-01-30 14:31:00.651050"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 37ms (Views: 0.5ms | ActiveRecord: 8.5ms | Allocations: 14961)


Started GET "/states" for ::1 at 2022-01-30 15:31:12 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (1.0ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:31:13Z\\\"}}\""], ["updated_at", "2022-01-30 14:31:13.005110"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 25ms (Views: 3.4ms | ActiveRecord: 4.4ms | Allocations: 9777)


Started DELETE "/states/1" for ::1 at 2022-01-30 15:32:14 +0100
  [1m[35m (1.0ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by StatesController#destroy as JSON
  Parameters: {"state"=>{"name"=>"Designed", "order"=>5}, "id"=>"1"}
  [1m[36mUser Load (0.6ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.5ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.7ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.6ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:32:14.618314', "order" = ("states"."order" - 1) WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Update (0.5ms)[0m  [1m[33mUPDATE "states" SET "order" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["order", nil], ["updated_at", "2022-01-30 14:32:14.620692"], ["id", 1]]
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" = 0)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Load (0.5ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
Completed 500 Internal Server Error in 179ms (ActiveRecord: 17.6ms | Allocations: 28409)


  
ActiveRecord::StatementInvalid (PG::SyntaxError: ERROR:  syntax error at or near ")"
LINE 1: ...NT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )
                                                                      ^
):
  
app/models/state.rb:20:in `default_values'
app/models/state.rb:34:in `update_order'
app/models/state.rb:38:in `remove_state_from_list'
app/controllers/states_controller.rb:33:in `destroy'
Started DELETE "/states/1" for ::1 at 2022-01-30 15:32:49 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"state"=>{"name"=>"Designed", "order"=>5}, "id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.5ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.9ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.6ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:32:49.892345', "order" = ("states"."order" - 1) WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Update (0.5ms)[0m  [1m[33mUPDATE "states" SET "order" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["order", nil], ["updated_at", "2022-01-30 14:32:49.894833"], ["id", 1]]
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" = 0)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
Completed 500 Internal Server Error in 27ms (ActiveRecord: 5.9ms | Allocations: 10199)


  
ActiveRecord::StatementInvalid (PG::SyntaxError: ERROR:  syntax error at or near ")"
LINE 1: ...NT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )
                                                                      ^
):
  
app/models/state.rb:20:in `default_values'
app/models/state.rb:34:in `update_order'
app/models/state.rb:38:in `remove_state_from_list'
app/controllers/states_controller.rb:33:in `destroy'
Started DELETE "/states/1" for ::1 at 2022-01-30 15:33:28 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.6ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.5ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.5ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:33:28.061643', "order" = ("states"."order" - 1) WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Update (0.6ms)[0m  [1m[33mUPDATE "states" SET "order" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["order", nil], ["updated_at", "2022-01-30 14:33:28.063607"], ["id", 1]]
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" = 0)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Load (0.6ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
Completed 500 Internal Server Error in 26ms (ActiveRecord: 5.5ms | Allocations: 10191)


  
ActiveRecord::StatementInvalid (PG::SyntaxError: ERROR:  syntax error at or near ")"
LINE 1: ...NT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )
                                                                      ^
):
  
app/models/state.rb:20:in `default_values'
app/models/state.rb:34:in `update_order'
app/models/state.rb:38:in `remove_state_from_list'
app/controllers/states_controller.rb:33:in `destroy'
Started DELETE "/states/1888" for ::1 at 2022-01-30 15:33:54 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"1888"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1888], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
Filter chain halted as :set_state rendered or redirected
Completed 404 Not Found in 3ms (Views: 0.2ms | ActiveRecord: 0.7ms | Allocations: 1910)


Started DELETE "/states/1" for ::1 at 2022-01-30 15:33:59 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.8ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:33:59.326889', "order" = ("states"."order" - 1) WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Update (0.4ms)[0m  [1m[33mUPDATE "states" SET "order" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["order", nil], ["updated_at", "2022-01-30 14:33:59.328558"], ["id", 1]]
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" = 0)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Load (0.6ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
Completed 500 Internal Server Error in 24ms (ActiveRecord: 5.1ms | Allocations: 10166)


  
ActiveRecord::StatementInvalid (PG::SyntaxError: ERROR:  syntax error at or near ")"
LINE 1: ...NT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )
                                                                      ^
):
  
app/models/state.rb:20:in `default_values'
app/models/state.rb:34:in `update_order'
app/models/state.rb:38:in `remove_state_from_list'
app/controllers/states_controller.rb:33:in `destroy'
Started DELETE "/states/1" for ::1 at 2022-01-30 15:43:37 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.5ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:43:38.003261', "order" = ("states"."order" - 1) WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "order" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["order", nil], ["updated_at", "2022-01-30 14:43:38.004300"], ["id", 1]]
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" = 0)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Load (0.1ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
Completed 500 Internal Server Error in 16ms (ActiveRecord: 3.5ms | Allocations: 10358)


  
ActiveRecord::StatementInvalid (PG::SyntaxError: ERROR:  syntax error at or near ")"
LINE 1: ...NT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )
                                                                      ^
):
  
app/models/state.rb:20:in `default_values'
app/models/state.rb:34:in `update_order'
app/models/state.rb:38:in `remove_state_from_list'
app/controllers/states_controller.rb:33:in `destroy'
Started DELETE "/states/1" for ::1 at 2022-01-30 15:44:43 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"1"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 1], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.2ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.2ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:44:43.146151', "order" = ("states"."order" - 1) WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:44:43Z\\\"}}\""], ["updated_at", "2022-01-30 14:44:43.154254"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 115ms (Views: 0.1ms | ActiveRecord: 11.9ms | Allocations: 30902)


Started GET "/states" for ::1 at 2022-01-30 15:44:48 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:44:48Z\\\"}}\""], ["updated_at", "2022-01-30 14:44:48.172118"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 13ms (Views: 1.5ms | ActiveRecord: 3.5ms | Allocations: 9708)


Started DELETE "/states/5" for ::1 at 2022-01-30 15:44:59 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"5"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 5]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.3ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 5]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:44:59.342788', "order" = ("states"."order" - 1) WHERE (1 = 1) AND ("states"."order" > 6)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:44:59Z\\\"}}\""], ["updated_at", "2022-01-30 14:44:59.351390"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 20ms (Views: 0.1ms | ActiveRecord: 5.9ms | Allocations: 14264)


Started DELETE "/states/5" for ::1 at 2022-01-30 15:45:03 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"5"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 5], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
Filter chain halted as :set_state rendered or redirected
Completed 404 Not Found in 4ms (Views: 0.1ms | ActiveRecord: 0.8ms | Allocations: 1858)


Started GET "/states" for ::1 at 2022-01-30 15:45:08 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:45:08Z\\\"}}\""], ["updated_at", "2022-01-30 14:45:08.366194"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 12ms (Views: 1.1ms | ActiveRecord: 3.7ms | Allocations: 9564)


Started GET "/states" for ::1 at 2022-01-30 15:48:47 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:48:47Z\\\"}}\""], ["updated_at", "2022-01-30 14:48:47.356208"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 95ms (Views: 3.7ms | ActiveRecord: 7.7ms | Allocations: 22883)


Started POST "/states" for ::1 at 2022-01-30 15:52:23 +0100
Error occurred while parsing request parameters.
Contents:

{"state": {
    "name": "xxxxxxxx",
}
}
Processing by StatesController#create as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Completed 400 Bad Request in 78ms (ActiveRecord: 2.5ms | Allocations: 12092)


  
ActionDispatch::Http::Parameters::ParseError (783: unexpected token at '{"state": {
    "name": "xxxxxxxx",
}
}'):
  
app/controllers/states_controller.rb:45:in `state_params'
app/controllers/states_controller.rb:16:in `create'
Started POST "/states" for ::1 at 2022-01-30 15:52:30 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"xxxxxxxx"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 5)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:52:30.705506', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 5)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "xxxxxxxx"], ["order", 5], ["created_at", "2022-01-30 14:52:30.702860"], ["updated_at", "2022-01-30 14:52:30.702860"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:52:30Z\\\"}}\""], ["updated_at", "2022-01-30 14:52:30.720033"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 36ms (Views: 0.4ms | ActiveRecord: 8.8ms | Allocations: 18666)


Started POST "/states" for ::1 at 2022-01-30 15:52:38 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"ssss"}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_order'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= 6)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.1ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:52:38.086101', "order" = ("states"."order" + 1) WHERE (1 = 1) AND ("states"."order" >= 6)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "order", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "ssss"], ["order", 6], ["created_at", "2022-01-30 14:52:38.084795"], ["updated_at", "2022-01-30 14:52:38.084795"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 14], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:52:38Z\\\"}}\""], ["updated_at", "2022-01-30 14:52:38.098431"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 21ms (Views: 0.2ms | ActiveRecord: 5.8ms | Allocations: 15497)


Started GET "/states" for ::1 at 2022-01-30 15:52:42 +0100
Processing by StatesController#index as JSON
  Parameters: {"email"=>"admin_1@gmail.com", "password"=>"[FILTERED]", "state"=>{}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."order" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T14:52:42Z\\\"}}\""], ["updated_at", "2022-01-30 14:52:42.400878"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 15ms (Views: 1.7ms | ActiveRecord: 4.0ms | Allocations: 9678)


Started DELETE "/states/9" for ::1 at 2022-01-30 15:52:52 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"9"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
Completed 500 Internal Server Error in 9ms (ActiveRecord: 0.3ms | Allocations: 4033)


  
NoMethodError (private method `remove_state_from_list' called for #<State:0x000055fe9f2e7bd0>
Did you mean?  remove_from_list):
  
app/controllers/states_controller.rb:33:in `destroy'
Started DELETE "/states/9" for ::1 at 2022-01-30 15:53:11 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"9"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" > 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (1.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 14:53:11.586467', "order" = ("states"."order" - 1) WHERE (1 = 1) AND ("states"."order" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "order" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["order", nil], ["updated_at", "2022-01-30 14:53:11.589009"], ["id", 9]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_order'
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
Completed 500 Internal Server Error in 96ms (ActiveRecord: 7.7ms | Allocations: 23145)


  
ActiveRecord::StatementInvalid (PG::SyntaxError: ERROR:  syntax error at or near ")"
LINE 1: ...NT(*) FROM "states" WHERE (1 = 1) AND ("states"."order" >= )
                                                                      ^
):
  
app/models/state.rb:20:in `default_values'
app/models/state.rb:34:in `update_order'
app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT pg_try_advisory_lock(6259495107986884680)[0m
  [1m[35m (0.4ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Migrating to RenameColumnStates (20220130145647)
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[35m (1.2ms)[0m  [1m[35mALTER TABLE "states" RENAME COLUMN "order" TO "position"[0m
  [1m[36mActiveRecord::SchemaMigration Create (0.3ms)[0m  [1m[32mINSERT INTO "schema_migrations" ("version") VALUES ($1) RETURNING "version"[0m  [["version", "20220130145647"]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  [1m[36mActiveRecord::InternalMetadata Load (0.1ms)[0m  [1m[34mSELECT "ar_internal_metadata".* FROM "ar_internal_metadata" WHERE "ar_internal_metadata"."key" = $1 LIMIT $2[0m  [["key", "environment"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT pg_advisory_unlock(6259495107986884680)[0m
  [1m[35m (0.5ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Started GET "/states" for ::1 at 2022-01-30 16:00:28 +0100
  [1m[35m (0.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:00:28Z\\\"}}\""], ["updated_at", "2022-01-30 15:00:28.713420"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 96ms (Views: 4.8ms | ActiveRecord: 3.9ms | Allocations: 24446)


Started DELETE "/states/9" for ::1 at 2022-01-30 16:00:38 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"9"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
Completed 500 Internal Server Error in 8ms (ActiveRecord: 0.5ms | Allocations: 5148)


  
NoMethodError (undefined method `postion' for #<State:0x00007fb7d88cdba0>
Did you mean?  position=):
  
app/models/state.rb:20:in `default_values'
app/controllers/states_controller.rb:33:in `destroy'
Started DELETE "/states/9" for ::1 at 2022-01-30 16:01:41 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"9"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (1.5ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:01:41.449951', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:01:41.452813"], ["id", 9]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:01:41Z\\\"}}\""], ["updated_at", "2022-01-30 15:01:41.464120"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 110ms (Views: 0.2ms | ActiveRecord: 11.6ms | Allocations: 28801)


Started GET "/states" for ::1 at 2022-01-30 16:01:48 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:01:48Z\\\"}}\""], ["updated_at", "2022-01-30 15:01:48.369062"], ["id", 3]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 17ms (Views: 1.2ms | ActiveRecord: 3.8ms | Allocations: 9668)


Started DELETE "/states/9" for ::1 at 2022-01-30 16:02:21 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"9"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:02:21Z\\\"}}\""], ["updated_at", "2022-01-30 15:02:21.859738"], ["id", 3]]
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 126ms (Views: 0.1ms | ActiveRecord: 8.1ms | Allocations: 24111)


Started DELETE "/states/9" for ::1 at 2022-01-30 16:02:36 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"9"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.4ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 9]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.3ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 9]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:02:36Z\\\"}}\""], ["updated_at", "2022-01-30 15:02:36.630868"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 116ms (Views: 0.1ms | ActiveRecord: 13.2ms | Allocations: 29075)


Started DELETE "/states/9" for ::1 at 2022-01-30 16:02:39 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"9"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 9], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
Filter chain halted as :set_state rendered or redirected
Completed 404 Not Found in 2ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 1858)


Started GET "/states" for ::1 at 2022-01-30 16:02:43 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:02:43Z\\\"}}\""], ["updated_at", "2022-01-30 15:02:43.756975"], ["id", 3]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 13ms (Views: 1.4ms | ActiveRecord: 3.7ms | Allocations: 9561)


Started DELETE "/states/10" for ::1 at 2022-01-30 16:02:55 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"10"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 10]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:02:55.084831', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:02:55.085732"], ["id", 10]]
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/models/state.rb:38:in `remove_state_from_list'
  [1m[36mState Destroy (0.3ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 10]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:02:55Z\\\"}}\""], ["updated_at", "2022-01-30 15:02:55.097627"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 30ms (Views: 0.1ms | ActiveRecord: 6.7ms | Allocations: 16039)


Started GET "/states" for ::1 at 2022-01-30 16:02:59 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:02:59Z\\\"}}\""], ["updated_at", "2022-01-30 15:02:59.923148"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 18ms (Views: 2.4ms | ActiveRecord: 3.5ms | Allocations: 9452)


Started DELETE "/states/10" for ::1 at 2022-01-30 16:05:03 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"10"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 10], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
Filter chain halted as :set_state rendered or redirected
Completed 404 Not Found in 107ms (Views: 0.2ms | ActiveRecord: 4.1ms | Allocations: 14477)


Started DELETE "/states/11" for ::1 at 2022-01-30 16:05:07 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"11"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 11], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 11]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:05:07.386895', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:05:07.388253"], ["id", 11]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.3ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 11]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:05:07Z\\\"}}\""], ["updated_at", "2022-01-30 15:05:07.401415"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 35ms (Views: 0.2ms | ActiveRecord: 9.6ms | Allocations: 20381)


Started GET "/states" for ::1 at 2022-01-30 16:05:11 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:05:11Z\\\"}}\""], ["updated_at", "2022-01-30 15:05:11.961188"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 18ms (Views: 4.9ms | ActiveRecord: 3.9ms | Allocations: 9347)


Started DELETE "/states/12" for ::1 at 2022-01-30 16:05:41 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"12"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 80ms (ActiveRecord: 2.1ms | Allocations: 12186)


  
SyntaxError (/home/seif/CV/xpark/xpark_backend/app/models/state.rb:3: syntax error, unexpected tLABEL, expecting '='
  acts_as_list, top_of_list: 0
                ^~~~~~~~~~~~
):
  
app/models/state.rb:3: syntax error, unexpected tLABEL, expecting '='
app/models/state.rb:3: syntax error, unexpected tLABEL, expecting '='
app/controllers/states_controller.rb:40:in `set_state'
Started DELETE "/states/12" for ::1 at 2022-01-30 16:06:05 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"12"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 12], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.2ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 12]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:06:05.965486', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:06:05.967095"], ["id", 12]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.1ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 12]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:06:05Z\\\"}}\""], ["updated_at", "2022-01-30 15:06:05.981224"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 114ms (Views: 0.1ms | ActiveRecord: 11.3ms | Allocations: 33002)


Started GET "/states" for ::1 at 2022-01-30 16:06:10 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.6ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:06:10Z\\\"}}\""], ["updated_at", "2022-01-30 15:06:10.790884"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 15ms (Views: 1.6ms | ActiveRecord: 3.9ms | Allocations: 9240)


Started DELETE "/states/13" for ::1 at 2022-01-30 16:08:58 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"13"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.5ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 13], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.4ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 13]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.5ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:08:58.350054', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.5ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:08:58.352647"], ["id", 13]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.4ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 13]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:08:58Z\\\"}}\""], ["updated_at", "2022-01-30 15:08:58.373873"], ["id", 3]]
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 188ms (Views: 0.2ms | ActiveRecord: 18.3ms | Allocations: 33077)


Started DELETE "/states/14" for ::1 at 2022-01-30 16:09:11 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"14"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 14], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 14], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 14]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:09:11.776769', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:09:11.779577"], ["id", 14]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.3ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 14]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:09:11Z\\\"}}\""], ["updated_at", "2022-01-30 15:09:11.804796"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 50ms (Views: 0.1ms | ActiveRecord: 7.4ms | Allocations: 16568)


Started POST "/states" for ::1 at 2022-01-30 16:09:21 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"ssss"}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.7ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:09:21.798230', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "ssss"], ["position", 1], ["created_at", "2022-01-30 15:09:21.793446"], ["updated_at", "2022-01-30 15:09:21.793446"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
Completed 500 Internal Server Error in 32ms (ActiveRecord: 2.6ms | Allocations: 10980)


  
NoMethodError (undefined method `update_postion' for #<State:0x00007fb7d86b3f90>
Did you mean?  update_position
               update_positions):
  
app/controllers/states_controller.rb:17:in `create'
Started POST "/states" for ::1 at 2022-01-30 16:09:48 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"ssss"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:09:48.511588', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "ssss"], ["position", 1], ["created_at", "2022-01-30 15:09:48.509538"], ["updated_at", "2022-01-30 15:09:48.509538"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:09:48Z\\\"}}\""], ["updated_at", "2022-01-30 15:09:48.525220"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 109ms (Views: 0.3ms | ActiveRecord: 9.5ms | Allocations: 29406)


Started POST "/states" for ::1 at 2022-01-30 16:09:54 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"tttt"}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 2)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.1ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:09:54.301219', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 2)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "tttt"], ["position", 2], ["created_at", "2022-01-30 15:09:54.299731"], ["updated_at", "2022-01-30 15:09:54.299731"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 17], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:09:54Z\\\"}}\""], ["updated_at", "2022-01-30 15:09:54.313037"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 23ms (Views: 0.3ms | ActiveRecord: 6.1ms | Allocations: 15498)


Started POST "/states" for ::1 at 2022-01-30 16:09:59 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"gggg"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.6ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:09:59.452233', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.5ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "gggg"], ["position", 3], ["created_at", "2022-01-30 15:09:59.446704"], ["updated_at", "2022-01-30 15:09:59.446704"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.5ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 18], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:09:59Z\\\"}}\""], ["updated_at", "2022-01-30 15:09:59.477396"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 48ms (Views: 0.9ms | ActiveRecord: 9.2ms | Allocations: 15499)


Started POST "/states" for ::1 at 2022-01-30 16:10:04 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"ddd"}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 4)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:10:04.459340', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 4)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "ddd"], ["position", 4], ["created_at", "2022-01-30 15:10:04.457721"], ["updated_at", "2022-01-30 15:10:04.457721"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 19], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:10:04Z\\\"}}\""], ["updated_at", "2022-01-30 15:10:04.471731"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 24ms (Views: 0.3ms | ActiveRecord: 5.8ms | Allocations: 15499)


Started GET "/states" for ::1 at 2022-01-30 16:10:07 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:10:07Z\\\"}}\""], ["updated_at", "2022-01-30 15:10:07.803542"], ["id", 3]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 15ms (Views: 1.7ms | ActiveRecord: 3.9ms | Allocations: 9452)


Started GET "/states" for ::1 at 2022-01-30 16:10:20 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:10:20Z\\\"}}\""], ["updated_at", "2022-01-30 15:10:20.967234"], ["id", 3]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.2ms | ActiveRecord: 3.9ms | Allocations: 9450)


Started DELETE "/states/19" for ::1 at 2022-01-30 16:10:34 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"19"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 19], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 19]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 4)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:10:34.623254', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 4)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.4ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:10:34.624457"], ["id", 19]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.1ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 19]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:10:34Z\\\"}}\""], ["updated_at", "2022-01-30 15:10:34.636219"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 31ms (Views: 0.1ms | ActiveRecord: 8.4ms | Allocations: 19030)


Started GET "/states" for ::1 at 2022-01-30 16:10:38 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:10:38Z\\\"}}\""], ["updated_at", "2022-01-30 15:10:38.932867"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 13ms (Views: 1.1ms | ActiveRecord: 3.6ms | Allocations: 9342)


Started DELETE "/states/17" for ::1 at 2022-01-30 16:10:48 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"17"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 17], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 17], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.2ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 17]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 2)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:10:48.363525', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 2)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:10:48.365025"], ["id", 17]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.2ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 17]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:10:48Z\\\"}}\""], ["updated_at", "2022-01-30 15:10:48.376626"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 25ms (Views: 0.1ms | ActiveRecord: 6.5ms | Allocations: 16569)


Started GET "/states" for ::1 at 2022-01-30 16:10:52 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:10:52Z\\\"}}\""], ["updated_at", "2022-01-30 15:10:52.576792"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.0ms | ActiveRecord: 2.3ms | Allocations: 9235)


Started POST "/states" for ::1 at 2022-01-30 16:11:01 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"ddd"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:11:01.900410', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "ddd"], ["position", 3], ["created_at", "2022-01-30 15:11:01.898610"], ["updated_at", "2022-01-30 15:11:01.898610"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 20], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:11:01Z\\\"}}\""], ["updated_at", "2022-01-30 15:11:01.913358"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 23ms (Views: 0.3ms | ActiveRecord: 6.5ms | Allocations: 15501)


Started GET "/states" for ::1 at 2022-01-30 16:11:05 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:11:05Z\\\"}}\""], ["updated_at", "2022-01-30 15:11:05.631006"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.1ms | ActiveRecord: 3.4ms | Allocations: 9342)


Started POST "/states" for ::1 at 2022-01-30 16:11:30 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"ddd", "position"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:11:30.632516', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "ddd"], ["position", 1], ["created_at", "2022-01-30 15:11:30.631538"], ["updated_at", "2022-01-30 15:11:30.631538"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 21], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:11:30Z\\\"}}\""], ["updated_at", "2022-01-30 15:11:30.645518"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 22ms (Views: 0.3ms | ActiveRecord: 6.0ms | Allocations: 14962)


Started GET "/states" for ::1 at 2022-01-30 16:11:35 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:11:35Z\\\"}}\""], ["updated_at", "2022-01-30 15:11:35.080732"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.1ms | ActiveRecord: 3.7ms | Allocations: 9450)


Started DELETE "/states/21" for ::1 at 2022-01-30 16:11:46 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"21"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 21], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 21]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:11:46.157434', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:11:46.158572"], ["id", 21]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.3ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 21]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:11:46Z\\\"}}\""], ["updated_at", "2022-01-30 15:11:46.170396"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 24ms (Views: 0.1ms | ActiveRecord: 6.3ms | Allocations: 16568)


Started GET "/states" for ::1 at 2022-01-30 16:11:52 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:11:52Z\\\"}}\""], ["updated_at", "2022-01-30 15:11:52.254023"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.2ms | ActiveRecord: 3.1ms | Allocations: 9343)


Started GET "/states" for ::1 at 2022-01-30 16:12:50 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:12:50Z\\\"}}\""], ["updated_at", "2022-01-30 15:12:50.732450"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.3ms | ActiveRecord: 3.7ms | Allocations: 9345)


Started PATCH "/states/16" for ::1 at 2022-01-30 16:13:26 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"dfdfdfdfdf", "position"=>3}, "id"=>"16"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "position" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "dfdfdfdfdf"], ["position", 3], ["updated_at", "2022-01-30 15:13:26.043018"], ["id", 16]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 3)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:13:26Z\\\"}}\""], ["updated_at", "2022-01-30 15:13:26.053168"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 5.7ms | Allocations: 12875)


Started GET "/states" for ::1 at 2022-01-30 16:13:29 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:13:29Z\\\"}}\""], ["updated_at", "2022-01-30 15:13:29.624928"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 13ms (Views: 1.5ms | ActiveRecord: 3.6ms | Allocations: 9342)


Started PATCH "/states/16" for ::1 at 2022-01-30 16:14:36 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"dfdfdfdfdf", "position"=>3}, "id"=>"16"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 3)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:14:36Z\\\"}}\""], ["updated_at", "2022-01-30 15:14:36.664039"], ["id", 3]]
  [1m[35m (0.8ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 104ms (Views: 0.2ms | ActiveRecord: 8.1ms | Allocations: 26039)


Started GET "/states" for ::1 at 2022-01-30 16:14:41 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:14:41Z\\\"}}\""], ["updated_at", "2022-01-30 15:14:41.887554"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.3ms | ActiveRecord: 3.9ms | Allocations: 9343)


Started DELETE "/states/21" for ::1 at 2022-01-30 16:14:50 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"21"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 21], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
Filter chain halted as :set_state rendered or redirected
Completed 404 Not Found in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 1858)


Started DELETE "/states/16" for ::1 at 2022-01-30 16:14:53 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"16"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.4ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 16]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 3)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.5ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:14:53.554666', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 3)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
Completed 500 Internal Server Error in 15ms (ActiveRecord: 4.4ms | Allocations: 8069)


  
RuntimeError (Locking a record with unpersisted changes is not supported. Use `save` to persist the changes, or `reload` to discard them explicitly.):
  
app/models/state.rb:34:in `update_position'
app/controllers/states_controller.rb:33:in `destroy'
Started DELETE "/states/16" for ::1 at 2022-01-30 16:15:57 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"16"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.2ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 16]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 3)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:15:57.273098', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 3)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:15:57.274486"], ["id", 16]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.1ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 16]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:15:57Z\\\"}}\""], ["updated_at", "2022-01-30 15:15:57.289449"], ["id", 3]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 116ms (Views: 0.1ms | ActiveRecord: 12.2ms | Allocations: 33059)


Started GET "/states" for ::1 at 2022-01-30 16:16:09 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:16:09Z\\\"}}\""], ["updated_at", "2022-01-30 15:16:09.249958"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 16ms (Views: 1.3ms | ActiveRecord: 3.2ms | Allocations: 9240)


Started DELETE "/states/18" for ::1 at 2022-01-30 16:16:23 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"18"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 18], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 18], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 18]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 2)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:16:23.016295', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 2)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:16:23.017511"], ["id", 18]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.2ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 18]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:16:23Z\\\"}}\""], ["updated_at", "2022-01-30 15:16:23.027605"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 22ms (Views: 0.1ms | ActiveRecord: 5.7ms | Allocations: 16569)


Started DELETE "/states/20" for ::1 at 2022-01-30 16:16:25 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"id"=>"20"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 20], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 20], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.5ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 20]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 2)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.1ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:16:25.812538', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 2)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:16:25.813376"], ["id", 20]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.3ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 20]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:16:25Z\\\"}}\""], ["updated_at", "2022-01-30 15:16:25.824861"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 22ms (Views: 0.1ms | ActiveRecord: 6.3ms | Allocations: 16567)


Started PATCH "/states/16" for ::1 at 2022-01-30 16:16:46 +0100
Error occurred while parsing request parameters.
Contents:

{"state": {
    "name": "dfdfdfdfdf",
}
}
Processing by StatesController#update as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Completed 400 Bad Request in 2ms (ActiveRecord: 0.3ms | Allocations: 1306)


  
ActionDispatch::Http::Parameters::ParseError (783: unexpected token at '{"state": {
    "name": "dfdfdfdfdf",
}
}'):
  
app/controllers/states_controller.rb:40:in `set_state'
Started PATCH "/states/16" for ::1 at 2022-01-30 16:16:51 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"dfdfdfdfdf"}, "id"=>"16"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 16], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
Filter chain halted as :set_state rendered or redirected
Completed 404 Not Found in 3ms (Views: 0.1ms | ActiveRecord: 0.5ms | Allocations: 1865)


Started POST "/states" for ::1 at 2022-01-30 16:17:17 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"ddd"}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.1ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:17:17.618780', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "ddd"], ["position", 1], ["created_at", "2022-01-30 15:17:17.617165"], ["updated_at", "2022-01-30 15:17:17.617165"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 22], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:17:17Z\\\"}}\""], ["updated_at", "2022-01-30 15:17:17.631028"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 24ms (Views: 0.3ms | ActiveRecord: 5.7ms | Allocations: 15650)


Started POST "/states" for ::1 at 2022-01-30 16:17:24 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"ff"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 2)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:17:24.709622', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 2)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "ff"], ["position", 2], ["created_at", "2022-01-30 15:17:24.707439"], ["updated_at", "2022-01-30 15:17:24.707439"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.5ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 23], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:17:24Z\\\"}}\""], ["updated_at", "2022-01-30 15:17:24.725976"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 26ms (Views: 0.3ms | ActiveRecord: 6.5ms | Allocations: 15499)


Started POST "/states" for ::1 at 2022-01-30 16:17:30 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"gg"}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:17:30.018784', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "gg"], ["position", 3], ["created_at", "2022-01-30 15:17:30.017259"], ["updated_at", "2022-01-30 15:17:30.017259"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 24], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:17:30Z\\\"}}\""], ["updated_at", "2022-01-30 15:17:30.031173"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 23ms (Views: 0.2ms | ActiveRecord: 6.2ms | Allocations: 15499)


Started POST "/states" for ::1 at 2022-01-30 16:17:36 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"hhh"}}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 4)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:17:36.643728', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 4)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.6ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "hhh"], ["position", 4], ["created_at", "2022-01-30 15:17:36.638737"], ["updated_at", "2022-01-30 15:17:36.638737"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.5ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 25], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (3.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:17:36Z\\\"}}\""], ["updated_at", "2022-01-30 15:17:36.669429"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 49ms (Views: 0.4ms | ActiveRecord: 10.8ms | Allocations: 15499)


Started GET "/states" for ::1 at 2022-01-30 16:17:39 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:17:39Z\\\"}}\""], ["updated_at", "2022-01-30 15:17:39.983286"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.6ms | ActiveRecord: 3.4ms | Allocations: 9450)


Started PATCH "/states/23" for ::1 at 2022-01-30 16:20:39 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"dfdfdfdfdf", "position"=>1}, "id"=>"23"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 23], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "position" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "dfdfdfdfdf"], ["position", 1], ["updated_at", "2022-01-30 15:20:39.028314"], ["id", 23]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.8ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:20:39Z\\\"}}\""], ["updated_at", "2022-01-30 15:20:39.042998"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 24ms (Views: 0.2ms | ActiveRecord: 6.1ms | Allocations: 12874)


Started GET "/states" for ::1 at 2022-01-30 16:20:44 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:20:44Z\\\"}}\""], ["updated_at", "2022-01-30 15:20:44.448910"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 16ms (Views: 2.0ms | ActiveRecord: 3.9ms | Allocations: 9453)


Started PATCH "/states/22" for ::1 at 2022-01-30 16:21:26 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"2222", "position"=>2}, "id"=>"22"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "position" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "2222"], ["position", 2], ["updated_at", "2022-01-30 15:21:26.326059"], ["id", 22]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 2)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:21:26Z\\\"}}\""], ["updated_at", "2022-01-30 15:21:26.338463"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 5.8ms | Allocations: 12874)


Started GET "/states" for ::1 at 2022-01-30 16:21:34 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:21:34Z\\\"}}\""], ["updated_at", "2022-01-30 15:21:34.249531"], ["id", 3]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 27ms (Views: 2.8ms | ActiveRecord: 3.9ms | Allocations: 9450)


Started GET "/states" for ::1 at 2022-01-30 16:31:42 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.6ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:31:43Z\\\"}}\""], ["updated_at", "2022-01-30 15:31:43.045083"], ["id", 3]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 94ms (Views: 4.4ms | ActiveRecord: 3.8ms | Allocations: 24212)


Started PATCH "/states/22" for ::1 at 2022-01-30 16:31:56 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"2222", "position"=>1}, "id"=>"22"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[36mState Update (0.4ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 1], ["updated_at", "2022-01-30 15:31:56.565984"], ["id", 22]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:31:56Z\\\"}}\""], ["updated_at", "2022-01-30 15:31:56.577696"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 23ms (Views: 0.2ms | ActiveRecord: 6.0ms | Allocations: 13183)


Started GET "/states" for ::1 at 2022-01-30 16:32:01 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:32:01Z\\\"}}\""], ["updated_at", "2022-01-30 15:32:01.239198"], ["id", 3]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 16ms (Views: 1.5ms | ActiveRecord: 4.2ms | Allocations: 9450)


Started GET "/states" for ::1 at 2022-01-30 16:35:43 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:35:43Z\\\"}}\""], ["updated_at", "2022-01-30 15:35:43.417970"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 101ms (Views: 4.1ms | ActiveRecord: 8.3ms | Allocations: 24583)


Started PATCH "/states/23" for ::1 at 2022-01-30 16:35:51 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"2222", "position"=>1}, "id"=>"23"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 23], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[36mState Update (0.4ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["name", "2222"], ["updated_at", "2022-01-30 15:35:52.004396"], ["id", 23]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:35:52Z\\\"}}\""], ["updated_at", "2022-01-30 15:35:52.015804"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 22ms (Views: 0.3ms | ActiveRecord: 5.0ms | Allocations: 13183)


Started GET "/states" for ::1 at 2022-01-30 16:35:56 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:35:56Z\\\"}}\""], ["updated_at", "2022-01-30 15:35:56.462396"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 15ms (Views: 1.6ms | ActiveRecord: 4.0ms | Allocations: 9450)


Started DELETE "/states/23" for ::1 at 2022-01-30 16:36:09 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"state"=>{"name"=>"2222", "position"=>1}, "id"=>"23"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 23], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 23], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.4ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 23]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:36:09.412840', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.4ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:36:09.414096"], ["id", 23]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.3ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 23]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:36:09Z\\\"}}\""], ["updated_at", "2022-01-30 15:36:09.425575"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 31ms (Views: 0.1ms | ActiveRecord: 9.4ms | Allocations: 17691)


Started GET "/states" for ::1 at 2022-01-30 16:37:14 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:37:14Z\\\"}}\""], ["updated_at", "2022-01-30 15:37:14.753851"], ["id", 3]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 12ms (Views: 1.0ms | ActiveRecord: 3.5ms | Allocations: 9342)


Started POST "/states" for ::1 at 2022-01-30 16:37:50 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"hhh", "position"=>3}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:37:50.072597', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "hhh"], ["position", 3], ["created_at", "2022-01-30 15:37:50.071362"], ["updated_at", "2022-01-30 15:37:50.071362"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[35m (0.2ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
Completed 500 Internal Server Error in 15ms (ActiveRecord: 2.5ms | Allocations: 7204)


  
ArgumentError (wrong number of arguments (given 2, expected 0..1)):
  
app/models/state.rb:34:in `update_position'
app/controllers/states_controller.rb:17:in `create'
Started POST "/states" for ::1 at 2022-01-30 16:38:10 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"hhh", "position"=>3}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:38:10.594861', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "hhh"], ["position", 3], ["created_at", "2022-01-30 15:38:10.593788"], ["updated_at", "2022-01-30 15:38:10.593788"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 27], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:38:10Z\\\"}}\""], ["updated_at", "2022-01-30 15:38:10.608382"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 104ms (Views: 0.4ms | ActiveRecord: 9.0ms | Allocations: 28881)


Started GET "/states" for ::1 at 2022-01-30 16:38:17 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:38:17Z\\\"}}\""], ["updated_at", "2022-01-30 15:38:17.208668"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 13ms (Views: 1.2ms | ActiveRecord: 3.9ms | Allocations: 9450)


Started POST "/states" for ::1 at 2022-01-30 16:38:36 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"hhh", "position"=>1}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:28:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/models/state.rb:20:in `default_values'
  [1m[36mState Update All (0.1ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:38:36.306391', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "hhh"], ["position", 1], ["created_at", "2022-01-30 15:38:36.305573"], ["updated_at", "2022-01-30 15:38:36.305573"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:24:in `created_sequentially?'
  [1m[36mState Load (0.1ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 28], ["LIMIT", 1]]
  ↳ app/models/state.rb:34:in `update_position'
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:38:36Z\\\"}}\""], ["updated_at", "2022-01-30 15:38:36.319856"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 22ms (Views: 0.3ms | ActiveRecord: 5.9ms | Allocations: 14962)


Started GET "/states" for ::1 at 2022-01-30 16:38:39 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:38:39Z\\\"}}\""], ["updated_at", "2022-01-30 15:38:39.998848"], ["id", 3]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 17ms (Views: 1.2ms | ActiveRecord: 3.7ms | Allocations: 9559)


Started GET "/states" for ::1 at 2022-01-30 16:40:57 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.7ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:40:57Z\\\"}}\""], ["updated_at", "2022-01-30 15:40:57.789032"], ["id", 3]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 144ms (Views: 8.5ms | ActiveRecord: 12.3ms | Allocations: 24649)


Started DELETE "/states/24" for ::1 at 2022-01-30 16:41:14 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"state"=>{"name"=>"4242442", "position"=>1}, "id"=>"24"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 24], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 24], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 24]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 3)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:41:14.677801', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 3)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:41:14.679587"], ["id", 24]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.2ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 24]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:41:14Z\\\"}}\""], ["updated_at", "2022-01-30 15:41:14.696420"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 34ms (Views: 0.1ms | ActiveRecord: 8.7ms | Allocations: 17947)


Started GET "/states" for ::1 at 2022-01-30 16:41:23 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:41:23Z\\\"}}\""], ["updated_at", "2022-01-30 15:41:23.306233"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 12ms (Views: 1.2ms | ActiveRecord: 2.7ms | Allocations: 9451)


Started PATCH "/states/27" for ::1 at 2022-01-30 16:41:44 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"272727277", "position"=>1}, "id"=>"27"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 27], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "position" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "272727277"], ["position", 1], ["updated_at", "2022-01-30 15:41:44.700527"], ["id", 27]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:41:44Z\\\"}}\""], ["updated_at", "2022-01-30 15:41:44.711516"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 19ms (Views: 0.3ms | ActiveRecord: 5.4ms | Allocations: 12942)


Started GET "/states" for ::1 at 2022-01-30 16:41:48 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:41:48Z\\\"}}\""], ["updated_at", "2022-01-30 15:41:48.663162"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 17ms (Views: 1.9ms | ActiveRecord: 4.1ms | Allocations: 9450)


Started DELETE "/states/28" for ::1 at 2022-01-30 16:42:40 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"state"=>{"name"=>"4242442", "position"=>1}, "id"=>"28"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 28], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 28], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.2ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 28]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:42:40.145350', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:42:40.148485"], ["id", 28]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.2ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 28]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:42:40Z\\\"}}\""], ["updated_at", "2022-01-30 15:42:40.159264"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 110ms (Views: 0.1ms | ActiveRecord: 11.9ms | Allocations: 32768)


Started GET "/states" for ::1 at 2022-01-30 16:42:43 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:42:43Z\\\"}}\""], ["updated_at", "2022-01-30 15:42:43.890897"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.4ms | ActiveRecord: 3.6ms | Allocations: 9345)


Started DELETE "/states/27" for ::1 at 2022-01-30 16:42:59 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"state"=>{"name"=>"4242442", "position"=>1}, "id"=>"27"}
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 27], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.5ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 27], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (6.5ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 27]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.5ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:42:59.610648', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (6.9ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:42:59.616525"], ["id", 27]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.4ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 27]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:42:59Z\\\"}}\""], ["updated_at", "2022-01-30 15:42:59.643779"], ["id", 3]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 65ms (Views: 0.2ms | ActiveRecord: 22.5ms | Allocations: 17696)


Started GET "/states" for ::1 at 2022-01-30 16:43:03 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:43:03Z\\\"}}\""], ["updated_at", "2022-01-30 15:43:03.903906"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 13ms (Views: 1.0ms | ActiveRecord: 3.3ms | Allocations: 9237)


Started POST "/states" for ::1 at 2022-01-30 16:43:12 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"hhh", "position"=>1}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:43:12.444620', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "hhh"], ["position", 1], ["created_at", "2022-01-30 15:43:12.442920"], ["updated_at", "2022-01-30 15:43:12.442920"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:43:12Z\\\"}}\""], ["updated_at", "2022-01-30 15:43:12.464676"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 40ms (Views: 0.5ms | ActiveRecord: 6.8ms | Allocations: 14534)


Started GET "/states" for ::1 at 2022-01-30 16:43:16 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:43:16Z\\\"}}\""], ["updated_at", "2022-01-30 15:43:16.566998"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 29ms (Views: 2.9ms | ActiveRecord: 4.2ms | Allocations: 9342)


Started POST "/states" for ::1 at 2022-01-30 16:43:29 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"dfjhfjdfkjfh", "position"=>1}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:43:29.945760', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 1)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "dfjhfjdfkjfh"], ["position", 1], ["created_at", "2022-01-30 15:43:29.942168"], ["updated_at", "2022-01-30 15:43:29.942168"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:43:29Z\\\"}}\""], ["updated_at", "2022-01-30 15:43:29.962028"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 35ms (Views: 0.3ms | ActiveRecord: 5.8ms | Allocations: 14403)


Started GET "/states" for ::1 at 2022-01-30 16:43:33 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:43:33Z\\\"}}\""], ["updated_at", "2022-01-30 15:43:33.268820"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 17ms (Views: 1.7ms | ActiveRecord: 3.5ms | Allocations: 9452)


Started POST "/states" for ::1 at 2022-01-30 16:43:46 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"33333333", "position"=>3}}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 3)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:43:46.332142', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.3ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "33333333"], ["position", 3], ["created_at", "2022-01-30 15:43:46.330837"], ["updated_at", "2022-01-30 15:43:46.330837"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:43:46Z\\\"}}\""], ["updated_at", "2022-01-30 15:43:46.344592"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 23ms (Views: 0.6ms | ActiveRecord: 5.1ms | Allocations: 14403)


Started GET "/states" for ::1 at 2022-01-30 16:43:49 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:43:49Z\\\"}}\""], ["updated_at", "2022-01-30 15:43:49.710054"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 15ms (Views: 2.0ms | ActiveRecord: 3.7ms | Allocations: 9557)


Started PATCH "/states/22" for ::1 at 2022-01-30 16:44:21 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"222222222", "position"=>1}, "id"=>"22"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "position" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "222222222"], ["position", 1], ["updated_at", "2022-01-30 15:44:21.299190"], ["id", 22]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:44:21Z\\\"}}\""], ["updated_at", "2022-01-30 15:44:21.309866"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 20ms (Views: 0.2ms | ActiveRecord: 4.9ms | Allocations: 13867)


Started GET "/states" for ::1 at 2022-01-30 16:44:24 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:44:24Z\\\"}}\""], ["updated_at", "2022-01-30 15:44:24.591852"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 13ms (Views: 1.4ms | ActiveRecord: 3.5ms | Allocations: 9557)


Started DELETE "/states/25" for ::1 at 2022-01-30 16:45:31 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"state"=>{"name"=>"4242442", "position"=>1}, "id"=>"25"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 25], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 25], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 25]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 5)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:45:31.424315', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 5)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:45:31.425707"], ["id", 25]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.3ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 25]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:45:31Z\\\"}}\""], ["updated_at", "2022-01-30 15:45:31.437957"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 114ms (Views: 0.2ms | ActiveRecord: 13.1ms | Allocations: 31671)


Started GET "/states" for ::1 at 2022-01-30 16:45:35 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:45:35Z\\\"}}\""], ["updated_at", "2022-01-30 15:45:35.036184"], ["id", 3]]
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.7ms | ActiveRecord: 3.7ms | Allocations: 9453)


Started DELETE "/states/22" for ::1 at 2022-01-30 16:45:44 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"state"=>{"name"=>"4242442", "position"=>1}, "id"=>"22"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 22], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 22], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.2ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 22]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.1ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:45:44.856736', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.1ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:45:44.857694"], ["id", 22]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.1ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 22]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:45:44Z\\\"}}\""], ["updated_at", "2022-01-30 15:45:44.868995"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 22ms (Views: 0.2ms | ActiveRecord: 5.5ms | Allocations: 16574)


Started GET "/states" for ::1 at 2022-01-30 16:45:48 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:45:48Z\\\"}}\""], ["updated_at", "2022-01-30 15:45:48.775433"], ["id", 3]]
  [1m[35m (3.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 15ms (Views: 1.3ms | ActiveRecord: 4.6ms | Allocations: 9343)


Started DELETE "/states/29" for ::1 at 2022-01-30 16:45:57 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"state"=>{"name"=>"4242442", "position"=>1}, "id"=>"29"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 29], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 29], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.3ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 29]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:45:57.672942', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:45:57.673973"], ["id", 29]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.4ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 29]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:45:57Z\\\"}}\""], ["updated_at", "2022-01-30 15:45:57.685275"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 26ms (Views: 0.1ms | ActiveRecord: 6.6ms | Allocations: 16575)


Started GET "/states" for ::1 at 2022-01-30 16:46:02 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:46:02Z\\\"}}\""], ["updated_at", "2022-01-30 15:46:02.651732"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.7ms | ActiveRecord: 3.6ms | Allocations: 9236)


Started DELETE "/states/31" for ::1 at 2022-01-30 16:46:11 +0100
Processing by StatesController#destroy as JSON
  Parameters: {"state"=>{"name"=>"4242442", "position"=>1}, "id"=>"31"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 31], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Load (0.2ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 31], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mVehicle Update All (0.2ms)[0m  [1m[33mUPDATE "vehicles" SET "current_state_id" = $1 WHERE "vehicles"."current_state_id" = $2[0m  [["current_state_id", nil], ["current_state_id", 31]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 15:46:11.658556', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", nil], ["updated_at", "2022-01-30 15:46:11.659591"], ["id", 31]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 0)[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mState Destroy (0.4ms)[0m  [1m[31mDELETE FROM "states" WHERE "states"."id" = $1[0m  [["id", 31]]
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:33:in `destroy'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T15:46:11Z\\\"}}\""], ["updated_at", "2022-01-30 15:46:11.672054"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 23ms (Views: 0.1ms | ActiveRecord: 6.5ms | Allocations: 16575)


Started GET "/states" for ::1 at 2022-01-30 17:18:41 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:18:41Z\\\"}}\""], ["updated_at", "2022-01-30 16:18:41.832970"], ["id", 3]]
  [1m[35m (1.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 17ms (Views: 1.3ms | ActiveRecord: 3.2ms | Allocations: 9317)


Started POST "/states" for ::1 at 2022-01-30 17:18:55 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"hhh", "position"=>3}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:18:55Z\\\"}}\""], ["updated_at", "2022-01-30 16:18:55.721233"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 21ms (Views: 0.1ms | ActiveRecord: 4.1ms | Allocations: 17142)


Started POST "/states" for ::1 at 2022-01-30 17:19:05 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"hhh", "position"=>2}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 2)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 16:19:05.790804', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 2)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "hhh"], ["position", 2], ["created_at", "2022-01-30 16:19:05.786259"], ["updated_at", "2022-01-30 16:19:05.786259"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:19:05Z\\\"}}\""], ["updated_at", "2022-01-30 16:19:05.803485"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 26ms (Views: 0.3ms | ActiveRecord: 5.9ms | Allocations: 13532)


Started POST "/states" for ::1 at 2022-01-30 17:19:18 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"3333", "position"=>3}}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.1ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 16:19:18.141180', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 3)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.2ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "3333"], ["position", 3], ["created_at", "2022-01-30 16:19:18.140282"], ["updated_at", "2022-01-30 16:19:18.140282"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:19:18Z\\\"}}\""], ["updated_at", "2022-01-30 16:19:18.153020"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 21ms (Views: 0.3ms | ActiveRecord: 5.5ms | Allocations: 13467)


Started POST "/states" for ::1 at 2022-01-30 17:19:24 +0100
Processing by StatesController#create as JSON
  Parameters: {"state"=>{"name"=>"4444", "position"=>4}}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 4)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 16:19:24.320683', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 4)[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mState Create (0.4ms)[0m  [1m[32mINSERT INTO "states" ("name", "position", "created_at", "updated_at") VALUES ($1, $2, $3, $4) RETURNING "id"[0m  [["name", "4444"], ["position", 4], ["created_at", "2022-01-30 16:19:24.319769"], ["updated_at", "2022-01-30 16:19:24.319769"]]
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:17:in `create'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:19:24Z\\\"}}\""], ["updated_at", "2022-01-30 16:19:24.331408"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 201 Created in 22ms (Views: 0.2ms | ActiveRecord: 4.9ms | Allocations: 13464)


Started GET "/states" for ::1 at 2022-01-30 17:19:35 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.6ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:19:35Z\\\"}}\""], ["updated_at", "2022-01-30 16:19:35.620611"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 29ms (Views: 2.6ms | ActiveRecord: 5.1ms | Allocations: 9451)


Started PATCH "/states/32" for ::1 at 2022-01-30 17:20:33 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"32323232", "position"=>4}, "id"=>"32"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 32], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "position" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "32323232"], ["position", 4], ["updated_at", "2022-01-30 16:20:33.674715"], ["id", 32]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:20:33Z\\\"}}\""], ["updated_at", "2022-01-30 16:20:33.686089"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 108ms (Views: 0.4ms | ActiveRecord: 9.8ms | Allocations: 26017)


Started GET "/states" for ::1 at 2022-01-30 17:20:38 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:20:38Z\\\"}}\""], ["updated_at", "2022-01-30 16:20:38.601858"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 15ms (Views: 1.3ms | ActiveRecord: 3.7ms | Allocations: 9450)


Started PATCH "/states/32" for ::1 at 2022-01-30 17:21:20 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"32323232", "position"=>4}, "id"=>"32"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 32], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:21:21Z\\\"}}\""], ["updated_at", "2022-01-30 16:21:21.155289"], ["id", 3]]
  [1m[35m (0.7ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 107ms (Views: 0.2ms | ActiveRecord: 7.4ms | Allocations: 26002)


Started GET "/states" for ::1 at 2022-01-30 17:21:25 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:21:25Z\\\"}}\""], ["updated_at", "2022-01-30 16:21:25.622856"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 12ms (Views: 1.2ms | ActiveRecord: 3.2ms | Allocations: 9451)


Started PATCH "/states/34" for ::1 at 2022-01-30 17:21:49 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"32323232", "position"=>2}, "id"=>"34"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 34], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.4ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "position" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "32323232"], ["position", 2], ["updated_at", "2022-01-30 16:21:49.141483"], ["id", 34]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 2)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:21:49Z\\\"}}\""], ["updated_at", "2022-01-30 16:21:49.153420"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 5.0ms | Allocations: 12875)


Started GET "/states" for ::1 at 2022-01-30 17:21:52 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:21:52Z\\\"}}\""], ["updated_at", "2022-01-30 16:21:52.793304"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.1ms | ActiveRecord: 3.5ms | Allocations: 9450)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:22:15 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>4}, "id"=>"33"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "position" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "333333333"], ["position", 4], ["updated_at", "2022-01-30 16:22:15.021473"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:22:15Z\\\"}}\""], ["updated_at", "2022-01-30 16:22:15.035944"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 22ms (Views: 0.3ms | ActiveRecord: 5.0ms | Allocations: 12873)


Started GET "/states" for ::1 at 2022-01-30 17:22:19 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:22:19Z\\\"}}\""], ["updated_at", "2022-01-30 16:22:19.809058"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 13ms (Views: 1.5ms | ActiveRecord: 3.3ms | Allocations: 9453)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:23:18 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>55}, "id"=>"33"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:23:18Z\\\"}}\""], ["updated_at", "2022-01-30 16:23:18.697759"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 15ms (Views: 0.1ms | ActiveRecord: 3.7ms | Allocations: 11680)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:23:23 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>5}, "id"=>"33"}
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.1ms)[0m  [1m[31mROLLBACK[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:23:23Z\\\"}}\""], ["updated_at", "2022-01-30 16:23:23.127437"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 422 Unprocessable Entity in 15ms (Views: 0.1ms | ActiveRecord: 3.4ms | Allocations: 11632)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:23:27 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>0}, "id"=>"33"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 1], ["updated_at", "2022-01-30 16:23:27.273948"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:23:27Z\\\"}}\""], ["updated_at", "2022-01-30 16:23:27.284491"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 19ms (Views: 0.2ms | ActiveRecord: 5.7ms | Allocations: 12861)


Started GET "/states" for ::1 at 2022-01-30 17:23:33 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:23:33Z\\\"}}\""], ["updated_at", "2022-01-30 16:23:33.186087"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 19ms (Views: 1.4ms | ActiveRecord: 3.3ms | Allocations: 9451)


Started GET "/states" for ::1 at 2022-01-30 17:27:40 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:27:40Z\\\"}}\""], ["updated_at", "2022-01-30 16:27:40.706580"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 103ms (Views: 4.4ms | ActiveRecord: 7.8ms | Allocations: 24545)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:27:54 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>3}, "id"=>"33"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 3], ["updated_at", "2022-01-30 16:27:54.916968"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 3)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:27:54Z\\\"}}\""], ["updated_at", "2022-01-30 16:27:54.928312"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 25ms (Views: 0.2ms | ActiveRecord: 5.6ms | Allocations: 13182)


Started GET "/states" for ::1 at 2022-01-30 17:27:58 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:27:58Z\\\"}}\""], ["updated_at", "2022-01-30 16:27:58.442444"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 15ms (Views: 1.4ms | ActiveRecord: 3.4ms | Allocations: 9450)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:28:12 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>4}, "id"=>"33"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 4], ["updated_at", "2022-01-30 16:28:12.407529"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (2.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:28:12Z\\\"}}\""], ["updated_at", "2022-01-30 16:28:12.432833"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 38ms (Views: 0.2ms | ActiveRecord: 6.3ms | Allocations: 12861)


Started GET "/states" for ::1 at 2022-01-30 17:28:16 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:28:16Z\\\"}}\""], ["updated_at", "2022-01-30 16:28:16.795725"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 27ms (Views: 3.7ms | ActiveRecord: 3.4ms | Allocations: 9450)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:28:38 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>4}, "id"=>"33"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:28:38Z\\\"}}\""], ["updated_at", "2022-01-30 16:28:38.817711"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 156ms (Views: 0.4ms | ActiveRecord: 16.0ms | Allocations: 26042)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:28:46 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>3}, "id"=>"33"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.5ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 3], ["updated_at", "2022-01-30 16:28:46.161001"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 3)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:28:46Z\\\"}}\""], ["updated_at", "2022-01-30 16:28:46.175775"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 26ms (Views: 0.8ms | ActiveRecord: 6.0ms | Allocations: 12861)


Started GET "/states" for ::1 at 2022-01-30 17:29:20 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:29:20Z\\\"}}\""], ["updated_at", "2022-01-30 16:29:20.580855"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 19ms (Views: 1.9ms | ActiveRecord: 3.9ms | Allocations: 9450)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:29:40 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>4}, "id"=>"33"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 4], ["updated_at", "2022-01-30 16:29:40.691744"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:29:59Z\\\"}}\""], ["updated_at", "2022-01-30 16:29:59.039509"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 18454ms (Views: 0.7ms | ActiveRecord: 10.6ms | Allocations: 65465)


Started GET "/states" for ::1 at 2022-01-30 17:30:35 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:30:35Z\\\"}}\""], ["updated_at", "2022-01-30 16:30:35.753937"], ["id", 3]]
  [1m[35m (0.9ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 97ms (Views: 3.9ms | ActiveRecord: 5.9ms | Allocations: 24539)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:30:45 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>3}, "id"=>"33"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 3], ["updated_at", "2022-01-30 16:30:45.750898"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 3)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/models/state.rb:33:in `update_position'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:30:45Z\\\"}}\""], ["updated_at", "2022-01-30 16:30:45.769604"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 28ms (Views: 0.3ms | ActiveRecord: 6.0ms | Allocations: 14055)


Started GET "/states" for ::1 at 2022-01-30 17:30:48 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:30:48Z\\\"}}\""], ["updated_at", "2022-01-30 16:30:48.891512"], ["id", 3]]
  [1m[35m (1.9ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.3ms | ActiveRecord: 3.5ms | Allocations: 9452)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:30:58 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>4}, "id"=>"33"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.1ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 4], ["updated_at", "2022-01-30 16:30:58.750729"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/models/state.rb:33:in `update_position'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:30:58Z\\\"}}\""], ["updated_at", "2022-01-30 16:30:58.764246"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 25ms (Views: 0.3ms | ActiveRecord: 4.8ms | Allocations: 13735)


Started GET "/states" for ::1 at 2022-01-30 17:31:02 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:31:02Z\\\"}}\""], ["updated_at", "2022-01-30 16:31:02.371634"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 30ms (Views: 3.3ms | ActiveRecord: 3.9ms | Allocations: 9451)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:31:08 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>4}, "id"=>"33"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.7ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mState Load (0.3ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/models/state.rb:33:in `update_position'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:31:08Z\\\"}}\""], ["updated_at", "2022-01-30 16:31:08.890487"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 36ms (Views: 0.2ms | ActiveRecord: 6.5ms | Allocations: 12868)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:31:13 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>3}, "id"=>"33"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 3], ["updated_at", "2022-01-30 16:31:13.081065"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 3)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mState Load (0.4ms)[0m  [1m[37mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/models/state.rb:33:in `update_position'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:31:13Z\\\"}}\""], ["updated_at", "2022-01-30 16:31:13.094226"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 26ms (Views: 0.3ms | ActiveRecord: 5.6ms | Allocations: 13735)


Started GET "/states" for ::1 at 2022-01-30 17:31:16 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.2ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:31:16Z\\\"}}\""], ["updated_at", "2022-01-30 16:31:16.242437"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 14ms (Views: 1.6ms | ActiveRecord: 3.3ms | Allocations: 9451)


Started GET "/states" for ::1 at 2022-01-30 17:31:54 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:31:54Z\\\"}}\""], ["updated_at", "2022-01-30 16:31:54.713472"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 103ms (Views: 4.5ms | ActiveRecord: 7.7ms | Allocations: 24553)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:32:10 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>4}, "id"=>"33"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 4], ["updated_at", "2022-01-30 16:32:10.254275"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35mCACHE  (0.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/models/state.rb:33:in `update_position'
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:32:10Z\\\"}}\""], ["updated_at", "2022-01-30 16:32:10.265326"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 25ms (Views: 0.3ms | ActiveRecord: 5.4ms | Allocations: 13783)


Started GET "/states" for ::1 at 2022-01-30 17:32:14 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:32:14Z\\\"}}\""], ["updated_at", "2022-01-30 16:32:14.369154"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 13ms (Views: 1.2ms | ActiveRecord: 3.4ms | Allocations: 9450)


Started GET "/states" for ::1 at 2022-01-30 17:33:05 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:33:05Z\\\"}}\""], ["updated_at", "2022-01-30 16:33:05.340689"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 110ms (Views: 8.7ms | ActiveRecord: 6.8ms | Allocations: 24559)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:33:13 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>3}, "id"=>"33"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 3], ["updated_at", "2022-01-30 16:33:13.493701"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 3)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.9ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:33:16Z\\\"}}\""], ["updated_at", "2022-01-30 16:33:16.303640"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 2822ms (Views: 0.5ms | ActiveRecord: 6.5ms | Allocations: 15202)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:33:26 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>4}, "id"=>"33"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 4], ["updated_at", "2022-01-30 16:33:26.451398"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:33:56Z\\\"}}\""], ["updated_at", "2022-01-30 16:33:56.174434"], ["id", 3]]
  [1m[35m (1.6ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 29736ms (Views: 0.5ms | ActiveRecord: 6.6ms | Allocations: 15963)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:33:59 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>4}, "id"=>"33"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.6ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:34:10Z\\\"}}\""], ["updated_at", "2022-01-30 16:34:10.072898"], ["id", 3]]
  [1m[35m (1.7ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 10546ms (Views: 1.7ms | ActiveRecord: 9.1ms | Allocations: 28336)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:34:14 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>3}, "id"=>"33"}
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (1.0ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 3) AND ("states"."position" < 4 AND "states".id != 33)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.4ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 16:34:20.004217', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 3) AND ("states"."position" < 4 AND "states".id != 33)[0m
  ↳ app/models/state.rb:34:in `update_position'
  [1m[36mState Update (0.3ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 3], ["updated_at", "2022-01-30 16:34:14.750526"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 3)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.2ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:34:20Z\\\"}}\""], ["updated_at", "2022-01-30 16:34:20.026046"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 5294ms (Views: 0.2ms | ActiveRecord: 7.1ms | Allocations: 16574)


Started GET "/states" for ::1 at 2022-01-30 17:34:27 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:34:27Z\\\"}}\""], ["updated_at", "2022-01-30 16:34:27.033396"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 30ms (Views: 3.3ms | ActiveRecord: 4.1ms | Allocations: 9451)


Started PATCH "/states/33" for ::1 at 2022-01-30 17:34:42 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"333333333", "position"=>4}, "id"=>"33"}
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 33], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.7ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 3) AND ("states"."position" <= 4 AND "states".id != 33)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.7ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 16:34:47.981203', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 3) AND ("states"."position" <= 4 AND "states".id != 33)[0m
  ↳ app/models/state.rb:34:in `update_position'
  [1m[36mState Update (0.5ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 4], ["updated_at", "2022-01-30 16:34:42.008787"], ["id", 33]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.6ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:34:47Z\\\"}}\""], ["updated_at", "2022-01-30 16:34:47.999934"], ["id", 3]]
  [1m[35m (1.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 5999ms (Views: 0.5ms | ActiveRecord: 6.8ms | Allocations: 17767)


Started GET "/states" for ::1 at 2022-01-30 17:34:56 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:34:56Z\\\"}}\""], ["updated_at", "2022-01-30 16:34:56.684533"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 18ms (Views: 2.0ms | ActiveRecord: 3.9ms | Allocations: 9450)


Started PATCH "/states/30" for ::1 at 2022-01-30 17:35:27 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"303030", "position"=>4}, "id"=>"30"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 30], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" > 1) AND ("states"."position" <= 4 AND "states".id != 30)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.3ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 16:35:27.165632', "position" = ("states"."position" - 1) WHERE (1 = 1) AND ("states"."position" > 1) AND ("states"."position" <= 4 AND "states".id != 30)[0m
  ↳ app/models/state.rb:33:in `update_position'
  [1m[36mState Update (0.4ms)[0m  [1m[33mUPDATE "states" SET "name" = $1, "position" = $2, "updated_at" = $3 WHERE "states"."id" = $4[0m  [["name", "303030"], ["position", 4], ["updated_at", "2022-01-30 16:35:27.164362"], ["id", 30]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 4)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.6ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:35:27Z\\\"}}\""], ["updated_at", "2022-01-30 16:35:27.177911"], ["id", 3]]
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 109ms (Views: 0.2ms | ActiveRecord: 11.3ms | Allocations: 28302)


Started GET "/states" for ::1 at 2022-01-30 17:35:30 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:35:30Z\\\"}}\""], ["updated_at", "2022-01-30 16:35:30.780207"], ["id", 3]]
  [1m[35m (2.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 16ms (Views: 1.6ms | ActiveRecord: 3.7ms | Allocations: 9451)


Started PATCH "/states/30" for ::1 at 2022-01-30 17:35:46 +0100
Processing by StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"303030", "position"=>1}, "id"=>"30"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 30], ["LIMIT", 1]]
  ↳ app/controllers/states_controller.rb:40:in `set_state'
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.2ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" >= 1) AND ("states"."position" < 4 AND "states".id != 30)[0m
  ↳ app/models/state.rb:19:in `default_values'
  [1m[36mState Update All (0.2ms)[0m  [1m[33mUPDATE "states" SET "updated_at" = '2022-01-30 16:35:46.355720', "position" = ("states"."position" + 1) WHERE (1 = 1) AND ("states"."position" >= 1) AND ("states"."position" < 4 AND "states".id != 30)[0m
  ↳ app/models/state.rb:33:in `update_position'
  [1m[36mState Update (0.2ms)[0m  [1m[33mUPDATE "states" SET "position" = $1, "updated_at" = $2 WHERE "states"."id" = $3[0m  [["position", 1], ["updated_at", "2022-01-30 16:35:46.354449"], ["id", 30]]
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (0.3ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[35m (1.3ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.3ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.4ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:35:46Z\\\"}}\""], ["updated_at", "2022-01-30 16:35:46.368585"], ["id", 3]]
  [1m[35m (1.1ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 22ms (Views: 0.3ms | ActiveRecord: 5.2ms | Allocations: 14246)


Started GET "/states" for ::1 at 2022-01-30 17:35:50 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.2ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.1ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.3ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T16:35:50Z\\\"}}\""], ["updated_at", "2022-01-30 16:35:50.092519"], ["id", 3]]
  [1m[35m (2.0ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 13ms (Views: 1.1ms | ActiveRecord: 3.4ms | Allocations: 9450)


Started GET "/states" for ::1 at 2022-01-30 19:03:23 +0100
Processing by StatesController#index as JSON
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.9ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.2ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T18:03:23Z\\\"}}\""], ["updated_at", "2022-01-30 18:03:23.192286"], ["id", 3]]
  [1m[35m (2.2ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 24ms (Views: 2.2ms | ActiveRecord: 4.7ms | Allocations: 9641)


Started GET "/api/v1/states" for ::1 at 2022-01-30 19:14:19 +0100
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (uninitialized constant Api::StatesController):
  
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:92:in `rescue in controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:81:in `controller_class'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:44:in `controller'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:49:in `block in serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:834:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.0.4.4) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/api/v1/states" for ::1 at 2022-01-30 19:15:05 +0100
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (uninitialized constant Api::StatesController):
  
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:92:in `rescue in controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:81:in `controller_class'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:44:in `controller'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:49:in `block in serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:834:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.0.4.4) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/api/v1/states" for ::1 at 2022-01-30 19:16:49 +0100
  [1m[35m (0.6ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
  
ActionController::RoutingError (uninitialized constant Api::StatesController):
  
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:92:in `rescue in controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:88:in `controller_class_for'
actionpack (6.0.4.4) lib/action_dispatch/http/request.rb:81:in `controller_class'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:44:in `controller'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:31:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:49:in `block in serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:834:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.0.4.4) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/api/v1/states" for ::1 at 2022-01-30 19:18:04 +0100
  [1m[35m (1.3ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Api::V1::StatesController#index as JSON
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/api/v1/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.7ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T18:18:04Z\\\"}}\""], ["updated_at", "2022-01-30 18:18:04.451576"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 161ms (Views: 8.0ms | ActiveRecord: 12.9ms | Allocations: 26338)


Started GET "/api/v1/states" for ::1 at 2022-01-30 19:18:25 +0100
  [1m[35m (0.7ms)[0m  [1m[34mSELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC[0m
Processing by Api::V1::StatesController#index as JSON
Completed 500 Internal Server Error in 92ms (ActiveRecord: 0.0ms | Allocations: 38641)


  
NoMethodError (undefined method `authenticate_api_user!' for #<Api::V1::StatesController:0x0000556bdfcf58f0>
Did you mean?  authenticate_api_v1_user!):
  
activesupport (6.0.4.4) lib/active_support/callbacks.rb:428:in `block in make_lambda'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:181:in `block (2 levels) in halting_and_conditional'
actionpack (6.0.4.4) lib/abstract_controller/callbacks.rb:34:in `block (2 levels) in <module:Callbacks>'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:182:in `block in halting_and_conditional'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:513:in `block in invoke_before'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:513:in `each'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:513:in `invoke_before'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:134:in `run_callbacks'
actionpack (6.0.4.4) lib/abstract_controller/callbacks.rb:41:in `process_action'
actionpack (6.0.4.4) lib/action_controller/metal/rescue.rb:22:in `process_action'
actionpack (6.0.4.4) lib/action_controller/metal/instrumentation.rb:33:in `block in process_action'
activesupport (6.0.4.4) lib/active_support/notifications.rb:180:in `block in instrument'
activesupport (6.0.4.4) lib/active_support/notifications/instrumenter.rb:24:in `instrument'
activesupport (6.0.4.4) lib/active_support/notifications.rb:180:in `instrument'
actionpack (6.0.4.4) lib/action_controller/metal/instrumentation.rb:32:in `process_action'
actionpack (6.0.4.4) lib/action_controller/metal/params_wrapper.rb:245:in `process_action'
activerecord (6.0.4.4) lib/active_record/railties/controller_runtime.rb:27:in `process_action'
actionpack (6.0.4.4) lib/abstract_controller/base.rb:136:in `process'
actionpack (6.0.4.4) lib/action_controller/metal.rb:190:in `dispatch'
actionpack (6.0.4.4) lib/action_controller/metal.rb:254:in `dispatch'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:50:in `dispatch'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:33:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:49:in `block in serve'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `each'
actionpack (6.0.4.4) lib/action_dispatch/journey/router.rb:32:in `serve'
actionpack (6.0.4.4) lib/action_dispatch/routing/route_set.rb:834:in `call'
rack-cors (1.1.1) lib/rack/cors.rb:100:in `call'
warden (1.2.9) lib/warden/manager.rb:36:in `block in call'
warden (1.2.9) lib/warden/manager.rb:34:in `catch'
warden (1.2.9) lib/warden/manager.rb:34:in `call'
rack (2.2.3) lib/rack/etag.rb:27:in `call'
rack (2.2.3) lib/rack/conditional_get.rb:27:in `call'
rack (2.2.3) lib/rack/head.rb:12:in `call'
activerecord (6.0.4.4) lib/active_record/migration.rb:567:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:27:in `block in call'
activesupport (6.0.4.4) lib/active_support/callbacks.rb:101:in `run_callbacks'
actionpack (6.0.4.4) lib/action_dispatch/middleware/callbacks.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/actionable_exceptions.rb:18:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:32:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started GET "/api/v1/states" for ::1 at 2022-01-30 19:19:04 +0100
Processing by Api::V1::StatesController#index as JSON
  [1m[36mUser Load (0.5ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.5ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/api/v1/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.8ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.5ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.5ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T18:19:04Z\\\"}}\""], ["updated_at", "2022-01-30 18:19:04.440374"], ["id", 3]]
  [1m[35m (1.5ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 171ms (Views: 10.3ms | ActiveRecord: 12.0ms | Allocations: 26228)


Started PATCH "/states/30" for ::1 at 2022-01-30 19:22:00 +0100
  
ActionController::RoutingError (No route matches [PATCH] "/states/30"):
  
actionpack (6.0.4.4) lib/action_dispatch/middleware/debug_exceptions.rb:36:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/show_exceptions.rb:33:in `call'
railties (6.0.4.4) lib/rails/rack/logger.rb:37:in `call_app'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `block in call'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `block in tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:28:in `tagged'
activesupport (6.0.4.4) lib/active_support/tagged_logging.rb:80:in `tagged'
railties (6.0.4.4) lib/rails/rack/logger.rb:26:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/remote_ip.rb:81:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/request_id.rb:27:in `call'
rack (2.2.3) lib/rack/runtime.rb:22:in `call'
activesupport (6.0.4.4) lib/active_support/cache/strategy/local_cache_middleware.rb:29:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/executor.rb:14:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/static.rb:126:in `call'
rack (2.2.3) lib/rack/sendfile.rb:110:in `call'
actionpack (6.0.4.4) lib/action_dispatch/middleware/host_authorization.rb:103:in `call'
railties (6.0.4.4) lib/rails/engine.rb:527:in `call'
puma (4.3.10) lib/puma/configuration.rb:228:in `call'
puma (4.3.10) lib/puma/server.rb:718:in `handle_request'
puma (4.3.10) lib/puma/server.rb:472:in `process_client'
puma (4.3.10) lib/puma/server.rb:328:in `block in run'
puma (4.3.10) lib/puma/thread_pool.rb:134:in `block in spawn_thread'
Started PATCH "/api/v1/states/30" for ::1 at 2022-01-30 19:22:12 +0100
Processing by Api::V1::StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"303030", "position"=>1}, "id"=>"30"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
Completed 500 Internal Server Error in 120ms (ActiveRecord: 0.3ms | Allocations: 76085)


  
NameError (undefined local variable or method `current_api_user' for #<Api::V1::StatesController:0x00007f1569dad600>
Did you mean?  current_api_v1_user
               @current_api_v1_user):
  
app/controllers/application_controller.rb:14:in `authorize_only_admin!'
Started PATCH "/api/v1/states/30" for ::1 at 2022-01-30 19:22:35 +0100
Processing by Api::V1::StatesController#update as JSON
  Parameters: {"state"=>{"name"=>"303030", "position"=>1}, "id"=>"30"}
  [1m[36mUser Load (0.3ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.3ms)[0m  [1m[34mSELECT "states".* FROM "states" WHERE "states"."id" = $1 LIMIT $2[0m  [["id", 30], ["LIMIT", 1]]
  ↳ app/controllers/api/v1/states_controller.rb:40:in `set_state'
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.4ms)[0m  [1m[34mSELECT COUNT(*) FROM "states"[0m
  ↳ app/models/state.rb:27:in `valid_position'
  [1m[35m (0.5ms)[0m  [1m[34mSELECT COUNT(*) FROM "states" WHERE (1 = 1) AND ("states"."position" = 1)[0m
  ↳ app/controllers/api/v1/states_controller.rb:25:in `update'
  [1m[35m (0.2ms)[0m  [1m[35mCOMMIT[0m
  ↳ app/controllers/api/v1/states_controller.rb:25:in `update'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.1ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.3ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.4ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T18:22:35Z\\\"}}\""], ["updated_at", "2022-01-30 18:22:35.628577"], ["id", 3]]
  [1m[35m (1.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 143ms (Views: 0.4ms | ActiveRecord: 12.5ms | Allocations: 26093)


Started GET "/api/v1/states" for ::1 at 2022-01-30 19:22:43 +0100
Processing by Api::V1::StatesController#index as JSON
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."uid" = $1 LIMIT $2[0m  [["uid", "admin_1@gmail.com"], ["LIMIT", 1]]
  [1m[36mState Load (0.4ms)[0m  [1m[34mSELECT "states".* FROM "states" ORDER BY "states"."position" ASC[0m
  ↳ app/controllers/api/v1/states_controller.rb:8:in `index'
  [1m[36mUser Load (0.4ms)[0m  [1m[34mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2[0m  [["id", 3], ["LIMIT", 1]]
  [1m[35m (0.2ms)[0m  [1m[35mBEGIN[0m
  [1m[36mUser Load (0.7ms)[0m  [1m[37mSELECT "users".* FROM "users" WHERE "users"."id" = $1 LIMIT $2 FOR UPDATE[0m  [["id", 3], ["LIMIT", 1]]
  [1m[36mUser Update (0.7ms)[0m  [1m[33mUPDATE "users" SET "tokens" = $1, "updated_at" = $2 WHERE "users"."id" = $3[0m  [["tokens", "\"{\\\"3pznXYw1w-M6_Y6d0pIxsg\\\":{\\\"token\\\":\\\"$2a$10$F1rgCm88XZz4fnH6S/ElBOecNlxNXWI5SvNkqp47nYnL4ZlC6zxwu\\\",\\\"expiry\\\":1644762166,\\\"last_token\\\":\\\"$2a$10$y.PYga8j0UDz7aubIOgEmuG76mAERoAOpaXGZXzm9I8cQYpoUoW5m\\\",\\\"updated_at\\\":\\\"2022-01-30T18:22:43Z\\\"}}\""], ["updated_at", "2022-01-30 18:22:43.556803"], ["id", 3]]
  [1m[35m (2.4ms)[0m  [1m[35mCOMMIT[0m
Completed 200 OK in 25ms (Views: 2.6ms | ActiveRecord: 5.2ms | Allocations: 9474)


